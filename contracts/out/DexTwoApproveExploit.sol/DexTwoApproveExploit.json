{"abi":[{"type":"constructor","inputs":[{"name":"_dexInstance","type":"address","internalType":"address"},{"name":"_token1","type":"address","internalType":"address"},{"name":"_token2","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"function","name":"checkBalances","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"},{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"dexInstance","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"drainTokens","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"token1","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"token2","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b506040516103f73803806103f7833981016040819052602b916085565b5f80546001600160a01b039485166001600160a01b03199182161790915560018054938516938216939093179092556002805491909316911617905560be565b80516001600160a01b03811681146080575f5ffd5b919050565b5f5f5f606084860312156096575f5ffd5b609d84606b565b925060a960208501606b565b915060b560408501606b565b90509250925092565b61032c806100cb5f395ff3fe608060405234801561000f575f5ffd5b5060043610610064575f3560e01c8063d21220a71161004d578063d21220a7146100b5578063e22ee616146100c8578063ef1706ce146100da575f5ffd5b806325be124e146100685780639e241e8514610098575b5f5ffd5b60025461007b906001600160a01b031681565b6040516001600160a01b0390911681526020015b60405180910390f35b6100a06100e4565b6040805192835260208301919091520161008f565b60015461007b906001600160a01b031681565b5f5461007b906001600160a01b031681565b6100e26101cb565b005b6001545f80546040516370a0823160e01b81526001600160a01b039182166004820152919283929116906370a0823190602401602060405180830381865afa158015610132573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061015691906102b9565b6002545f546040516370a0823160e01b81526001600160a01b0391821660048201529116906370a0823190602401602060405180830381865afa15801561019f573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101c391906102b9565b915091509091565b6001545f5460405163095ea7b360e01b81526001600160a01b0391821660048201525f19602482015291169063095ea7b3906044016020604051808303815f875af115801561021c573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061024091906102d0565b506002545f5460405163095ea7b360e01b81526001600160a01b0391821660048201525f19602482015291169063095ea7b3906044016020604051808303815f875af1158015610292573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102b691906102d0565b50565b5f602082840312156102c9575f5ffd5b5051919050565b5f602082840312156102e0575f5ffd5b815180151581146102ef575f5ffd5b939250505056fea26469706673582212200f0702b162f2e8cbbfd11e19e7fbbcc4d31b275ef3b9703758f912b7b689160964736f6c634300081c0033","sourceMap":"277:716:0:-:0;;;400:163;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;478:11;:26;;-1:-1:-1;;;;;478:26:0;;;-1:-1:-1;;;;;;478:26:0;;;;;;;;514:16;;;;;;;;;;;;;;;540:6;:16;;;;;;;;;;;277:716;;14:177:1;93:13;;-1:-1:-1;;;;;135:31:1;;125:42;;115:70;;181:1;178;171:12;115:70;14:177;;;:::o;196:378::-;284:6;292;300;353:2;341:9;332:7;328:23;324:32;321:52;;;369:1;366;359:12;321:52;392:40;422:9;392:40;:::i;:::-;382:50;;451:49;496:2;485:9;481:18;451:49;:::i;:::-;441:59;;519:49;564:2;553:9;549:18;519:49;:::i;:::-;509:59;;196:378;;;;;:::o;:::-;277:716:0;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f5ffd5b5060043610610064575f3560e01c8063d21220a71161004d578063d21220a7146100b5578063e22ee616146100c8578063ef1706ce146100da575f5ffd5b806325be124e146100685780639e241e8514610098575b5f5ffd5b60025461007b906001600160a01b031681565b6040516001600160a01b0390911681526020015b60405180910390f35b6100a06100e4565b6040805192835260208301919091520161008f565b60015461007b906001600160a01b031681565b5f5461007b906001600160a01b031681565b6100e26101cb565b005b6001545f80546040516370a0823160e01b81526001600160a01b039182166004820152919283929116906370a0823190602401602060405180830381865afa158015610132573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061015691906102b9565b6002545f546040516370a0823160e01b81526001600160a01b0391821660048201529116906370a0823190602401602060405180830381865afa15801561019f573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101c391906102b9565b915091509091565b6001545f5460405163095ea7b360e01b81526001600160a01b0391821660048201525f19602482015291169063095ea7b3906044016020604051808303815f875af115801561021c573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061024091906102d0565b506002545f5460405163095ea7b360e01b81526001600160a01b0391821660048201525f19602482015291169063095ea7b3906044016020604051808303815f875af1158015610292573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102b691906102d0565b50565b5f602082840312156102c9575f5ffd5b5051919050565b5f602082840312156102e0575f5ffd5b815180151581146102ef575f5ffd5b939250505056fea26469706673582212200f0702b162f2e8cbbfd11e19e7fbbcc4d31b275ef3b9703758f912b7b689160964736f6c634300081c0033","sourceMap":"277:716:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;372:21;;;;;-1:-1:-1;;;;;372:21:0;;;;;;-1:-1:-1;;;;;178:55:1;;;160:74;;148:2;133:18;372:21:0;;;;;;;;569:200;;;:::i;:::-;;;;419:25:1;;;475:2;460:18;;453:34;;;;392:18;569:200:0;245:248:1;345:21:0;;;;;-1:-1:-1;;;;;345:21:0;;;313:26;;;;;-1:-1:-1;;;;;313:26:0;;;775:216;;;:::i;:::-;;569:200;671:6;;615:7;689:11;;664:37;;-1:-1:-1;;;664:37:0;;-1:-1:-1;;;;;689:11:0;;;664:37;;;160:74:1;615:7:0;;;;671:6;;;664:24;;133:18:1;;664:37:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;722:6;;;740:11;715:37;;-1:-1:-1;;;715:37:0;;-1:-1:-1;;;;;740:11:0;;;715:37;;;160:74:1;722:6:0;;;715:24;;133:18:1;;715:37:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;643:119;;;;569:200;;:::o;775:216::-;885:6;;;901:11;878:48;;-1:-1:-1;;;878:48:0;;-1:-1:-1;;;;;901:11:0;;;878:48;;;861:74:1;-1:-1:-1;;951:18:1;;;944:34;885:6:0;;;878:22;;834:18:1;;878:48:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;-1:-1:-1;943:6:0;;;959:11;936:48;;-1:-1:-1;;;936:48:0;;-1:-1:-1;;;;;959:11:0;;;936:48;;;861:74:1;-1:-1:-1;;951:18:1;;;944:34;943:6:0;;;936:22;;834:18:1;;936:48:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;775:216::o;498:184:1:-;568:6;621:2;609:9;600:7;596:23;592:32;589:52;;;637:1;634;627:12;589:52;-1:-1:-1;660:16:1;;498:184;-1:-1:-1;498:184:1:o;989:277::-;1056:6;1109:2;1097:9;1088:7;1084:23;1080:32;1077:52;;;1125:1;1122;1115:12;1077:52;1157:9;1151:16;1210:5;1203:13;1196:21;1189:5;1186:32;1176:60;;1232:1;1229;1222:12;1176:60;1255:5;989:277;-1:-1:-1;;;989:277:1:o","linkReferences":{}},"methodIdentifiers":{"checkBalances()":"9e241e85","dexInstance()":"e22ee616","drainTokens()":"ef1706ce","token1()":"d21220a7","token2()":"25be124e"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.28+commit.7893614a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_dexInstance\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_token1\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_token2\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"checkBalances\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"dexInstance\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"drainTokens\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"token1\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"token2\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/answers/DexTwoApproveExploit.sol\":\"DexTwoApproveExploit\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/answers/DexTwoApproveExploit.sol\":{\"keccak256\":\"0xc55db00c2aeb2c90d11d3a15561f00f4ba3b6be5814edf20f40442ed8eea73cc\",\"urls\":[\"bzz-raw://719976192743955fff25b991fd8c272fff503f9fa6279203e2f42e6d6538449c\",\"dweb:/ipfs/QmNTSFxdQoCTMGK6AGNJrXPtVxUNKJfZzwsYdCecqvhAJB\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.28+commit.7893614a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_dexInstance","type":"address"},{"internalType":"address","name":"_token1","type":"address"},{"internalType":"address","name":"_token2","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"stateMutability":"view","type":"function","name":"checkBalances","outputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"dexInstance","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"drainTokens"},{"inputs":[],"stateMutability":"view","type":"function","name":"token1","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"token2","outputs":[{"internalType":"address","name":"","type":"address"}]}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/answers/DexTwoApproveExploit.sol":"DexTwoApproveExploit"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/answers/DexTwoApproveExploit.sol":{"keccak256":"0xc55db00c2aeb2c90d11d3a15561f00f4ba3b6be5814edf20f40442ed8eea73cc","urls":["bzz-raw://719976192743955fff25b991fd8c272fff503f9fa6279203e2f42e6d6538449c","dweb:/ipfs/QmNTSFxdQoCTMGK6AGNJrXPtVxUNKJfZzwsYdCecqvhAJB"],"license":null}},"version":1},"id":0}