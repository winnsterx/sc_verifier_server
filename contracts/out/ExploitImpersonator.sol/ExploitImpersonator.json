{"abi":[{"type":"constructor","inputs":[{"name":"_impersonator","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"function","name":"calculateMsgHash","inputs":[{"name":"lockId","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"pure"},{"type":"function","name":"checkExistingLocker","inputs":[],"outputs":[{"name":"locker","type":"address","internalType":"address"},{"name":"controller","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"exploitSignatureBug","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"impersonator","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"tryBecomeOwner","inputs":[],"outputs":[{"name":"currentOwner","type":"address","internalType":"address"}],"stateMutability":"view"}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b5060405161048c38038061048c833981016040819052602b91604e565b5f80546001600160a01b0319166001600160a01b03929092169190911790556079565b5f60208284031215605d575f5ffd5b81516001600160a01b03811681146072575f5ffd5b9392505050565b610406806100865f395ff3fe608060405234801561000f575f5ffd5b5060043610610064575f3560e01c80638b7c22811161004d5780638b7c2281146100a1578063a7e25bf7146100a9578063c8c1efe2146100d1575f5ffd5b806368e33f05146100685780638136fd9014610072575b5f5ffd5b61007061011f565b005b5f54610084906001600160a01b031681565b6040516001600160a01b0390911681526020015b60405180910390f35b6100846101ca565b6100b1610243565b604080516001600160a01b03938416815292909116602083015201610098565b6101116100df366004610341565b7f19457468657265756d205369676e6564204d6573736167653a0a3332000000005f908152601c91909152603c902090565b604051908152602001610098565b60408051608080825260a082019092525f91602082018180368337505060016020830152506002604080830191909152601b60608301525f5490517f61a423b10000000000000000000000000000000000000000000000000000000081529192506001600160a01b0316906361a423b19061019e908490600401610358565b5f604051808303815f87803b1580156101b5575f5ffd5b505af19250505080156101c6575060015b5050565b5f5f5f9054906101000a90046001600160a01b03166001600160a01b0316638da5cb5b6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561021a573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061023e91906103a3565b905090565b5f80546040517f809aab920000000000000000000000000000000000000000000000000000000081526004810183905282916001600160a01b03169063809aab9290602401602060405180830381865afa9250505080156102c1575060408051601f3d908101601f191682019092526102be918101906103a3565b60015b1561033d576001600160a01b0381161561033b57809250806001600160a01b031663f77c47916040518163ffffffff1660e01b8152600401602060405180830381865afa158015610314573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061033891906103a3565b91505b505b9091565b5f60208284031215610351575f5ffd5b5035919050565b602081525f82518060208401525f5b818110156103845760208186018101516040868401015201610367565b505f604082850101526040601f19601f83011684010191505092915050565b5f602082840312156103b3575f5ffd5b81516001600160a01b03811681146103c9575f5ffd5b939250505056fea2646970667358221220fb88651cd94c2b9a83c82b5125c8e4941de9ad5b27b6dbc17f3be27f4fb9851664736f6c634300081c0033","sourceMap":"562:2775:0:-:0;;;635:80;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;680:12;:28;;-1:-1:-1;;;;;;680:28:0;-1:-1:-1;;;;;680:28:0;;;;;;;;;;562:2775;;14:290:1;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:1;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:1:o;:::-;562:2775:0;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f5ffd5b5060043610610064575f3560e01c80638b7c22811161004d5780638b7c2281146100a1578063a7e25bf7146100a9578063c8c1efe2146100d1575f5ffd5b806368e33f05146100685780638136fd9014610072575b5f5ffd5b61007061011f565b005b5f54610084906001600160a01b031681565b6040516001600160a01b0390911681526020015b60405180910390f35b6100846101ca565b6100b1610243565b604080516001600160a01b03938416815292909116602083015201610098565b6101116100df366004610341565b7f19457468657265756d205369676e6564204d6573736167653a0a3332000000005f908152601c91909152603c902090565b604051908152602001610098565b60408051608080825260a082019092525f91602082018180368337505060016020830152506002604080830191909152601b60608301525f5490517f61a423b10000000000000000000000000000000000000000000000000000000081529192506001600160a01b0316906361a423b19061019e908490600401610358565b5f604051808303815f87803b1580156101b5575f5ffd5b505af19250505080156101c6575060015b5050565b5f5f5f9054906101000a90046001600160a01b03166001600160a01b0316638da5cb5b6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561021a573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061023e91906103a3565b905090565b5f80546040517f809aab920000000000000000000000000000000000000000000000000000000081526004810183905282916001600160a01b03169063809aab9290602401602060405180830381865afa9250505080156102c1575060408051601f3d908101601f191682019092526102be918101906103a3565b60015b1561033d576001600160a01b0381161561033b57809250806001600160a01b031663f77c47916040518163ffffffff1660e01b8152600401602060405180830381865afa158015610314573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061033891906103a3565b91505b505b9091565b5f60208284031215610351575f5ffd5b5035919050565b602081525f82518060208401525f5b818110156103845760208186018101516040868401015201610367565b505f604082850101526040601f19601f83011684010191505092915050565b5f602082840312156103b3575f5ffd5b81516001600160a01b03811681146103c9575f5ffd5b939250505056fea2646970667358221220fb88651cd94c2b9a83c82b5125c8e4941de9ad5b27b6dbc17f3be27f4fb9851664736f6c634300081c0033","sourceMap":"562:2775:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1174:1621;;;:::i;:::-;;597:27;;;;;-1:-1:-1;;;;;597:27:0;;;;;;-1:-1:-1;;;;;178:55:1;;;160:74;;148:2;133:18;597:27:0;;;;;;;;3197:138;;;:::i;770:346::-;;;:::i;:::-;;;;-1:-1:-1;;;;;437:55:1;;;419:74;;529:55;;;;524:2;509:18;;502:83;392:18;770:346:0;245::1;2858:298:0;;;;;;:::i;:::-;3003:34;2923:7;2990:48;;;3058:4;3051:20;;;;3111:4;3095:21;;;2858:298;;;;927:25:1;;;915:2;900:18;2858:298:0;781:177:1;1174:1621:0;1621:14;;;1631:3;1621:14;;;;;;;;;1596:22;;1621:14;;;;;;;;-1:-1:-1;;2093:66:0;2086:4;2071:20;;2064:96;-1:-1:-1;2256:66:0;2249:4;2234:20;;;2227:96;;;;2465:66;2458:4;2443:20;;2436:96;-1:-1:-1;2631:12:0;2617:52;;;;;2071:20;;-1:-1:-1;;;;;;2631:12:0;;2617:41;;:52;;2071:20;;2617:52;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2613:176;1214:1581;1174:1621::o;3197:138::-;3246:20;3307:12;;;;;;;;;-1:-1:-1;;;;;3307:12:0;-1:-1:-1;;;;;3293:33:0;;:35;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;3278:50;;3197:138;:::o;770:346::-;824:14;888:12;;874:38;;;;;;;;927:25:1;;;824:14:0;;-1:-1:-1;;;;;888:12:0;;874:35;;900:18:1;;874:38:0;;;;;;;;;;;;;;;;;;-1:-1:-1;874:38:0;;;;;;;;-1:-1:-1;;874:38:0;;;;;;;;;;;;:::i;:::-;;;870:240;;;-1:-1:-1;;;;;957:21:0;;;953:138;;1007:7;998:16;;1055:7;-1:-1:-1;;;;;1045:29:0;;:31;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1032:44;;953:138;913:188;870:240;770:346;;:::o;596:180:1:-;655:6;708:2;696:9;687:7;683:23;679:32;676:52;;;724:1;721;714:12;676:52;-1:-1:-1;747:23:1;;596:180;-1:-1:-1;596:180:1:o;1152:525::-;1299:2;1288:9;1281:21;1262:4;1331:6;1325:13;1374:6;1369:2;1358:9;1354:18;1347:34;1399:1;1409:140;1423:6;1420:1;1417:13;1409:140;;;1534:2;1518:14;;;1514:23;;1508:30;1503:2;1484:17;;;1480:26;1473:66;1438:10;1409:140;;;1413:3;1598:1;1593:2;1584:6;1573:9;1569:22;1565:31;1558:42;1668:2;1661;1657:7;1652:2;1644:6;1640:15;1636:29;1625:9;1621:45;1617:54;1609:62;;;1152:525;;;;:::o;1682:313::-;1752:6;1805:2;1793:9;1784:7;1780:23;1776:32;1773:52;;;1821:1;1818;1811:12;1773:52;1853:9;1847:16;-1:-1:-1;;;;;1896:5:1;1892:54;1885:5;1882:65;1872:93;;1961:1;1958;1951:12;1872:93;1984:5;1682:313;-1:-1:-1;;;1682:313:1:o","linkReferences":{}},"methodIdentifiers":{"calculateMsgHash(uint256)":"c8c1efe2","checkExistingLocker()":"a7e25bf7","exploitSignatureBug()":"68e33f05","impersonator()":"8136fd90","tryBecomeOwner()":"8b7c2281"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.28+commit.7893614a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_impersonator\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"lockId\",\"type\":\"uint256\"}],\"name\":\"calculateMsgHash\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"pure\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"checkExistingLocker\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"locker\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"controller\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"exploitSignatureBug\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"impersonator\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"tryBecomeOwner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"currentOwner\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/answers/ExploitImpersonator.sol\":\"ExploitImpersonator\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/answers/ExploitImpersonator.sol\":{\"keccak256\":\"0x040ce6e3b4c6c5e1678c49c0ef99a22c70750b043a79e412de393e0507469ef9\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://3d5ab11849119f213fd42a26a6f5786605f15cd35e4e01f02f4c18635bd8a449\",\"dweb:/ipfs/QmWqTUHewupMiC6CxHrE76ExnjnM7DhRTccQsQcsZ3B9Qs\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.28+commit.7893614a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_impersonator","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"uint256","name":"lockId","type":"uint256"}],"stateMutability":"pure","type":"function","name":"calculateMsgHash","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"checkExistingLocker","outputs":[{"internalType":"address","name":"locker","type":"address"},{"internalType":"address","name":"controller","type":"address"}]},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"exploitSignatureBug"},{"inputs":[],"stateMutability":"view","type":"function","name":"impersonator","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"tryBecomeOwner","outputs":[{"internalType":"address","name":"currentOwner","type":"address"}]}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/answers/ExploitImpersonator.sol":"ExploitImpersonator"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/answers/ExploitImpersonator.sol":{"keccak256":"0x040ce6e3b4c6c5e1678c49c0ef99a22c70750b043a79e412de393e0507469ef9","urls":["bzz-raw://3d5ab11849119f213fd42a26a6f5786605f15cd35e4e01f02f4c18635bd8a449","dweb:/ipfs/QmWqTUHewupMiC6CxHrE76ExnjnM7DhRTccQsQcsZ3B9Qs"],"license":"MIT"}},"version":1},"id":0}