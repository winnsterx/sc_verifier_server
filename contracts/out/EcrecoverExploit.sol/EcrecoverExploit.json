{"abi":[{"type":"function","name":"exploit","inputs":[{"name":"locker","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"findSignature","inputs":[{"name":"target","type":"address","internalType":"address"}],"outputs":[{"name":"found","type":"bool","internalType":"bool"},{"name":"v","type":"uint8","internalType":"uint8"},{"name":"r","type":"bytes32","internalType":"bytes32"},{"name":"s","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"getMsgHash","inputs":[],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"pure"},{"type":"function","name":"testEcrecover","inputs":[{"name":"msgHash","type":"bytes32","internalType":"bytes32"},{"name":"v","type":"uint8","internalType":"uint8"},{"name":"r","type":"bytes32","internalType":"bytes32"},{"name":"s","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"pure"}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b506106fe8061001c5f395ff3fe608060405234801561000f575f5ffd5b506004361061004a575f3560e01c80630aeb4ddf1461004e5780631040b0bc1461006357806328f8ec99146100a5578063aa6abb9b146100d0575b5f5ffd5b61006161005c366004610619565b610107565b005b7f19457468657265756d205369676e6564204d6573736167653a0a3332000000005f908152610539601c52603c90206040519081526020015b60405180910390f35b6100b86100b3366004610646565b61030c565b6040516001600160a01b03909116815260200161009c565b6100e36100de366004610619565b610371565b60408051941515855260ff909316602085015291830152606082015260800161009c565b5f306001600160a01b0316631040b0bc6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610144573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101689190610685565b90507342069d82d9592991704e6e41bf2589a76ead1a915f5b601e8160ff161015610306575f5b600a8110156102fd57604080515f8082526020820180845287905260ff851692820192909252606081018390526080810183905260019060a0016020604051602081039080840390855afa1580156101e9573d5f5f3e3d5ffd5b505050602060405103519050836001600160a01b0316816001600160a01b0316036102f45760405160ff8416602482015260448101839052606481018390523360848201525f906001600160a01b0388169060a40160408051601f198184030181529181526020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167f3e8cd57000000000000000000000000000000000000000000000000000000000179052516102a1919061069c565b5f604051808303815f865af19150503d805f81146102da576040519150601f19603f3d011682016040523d82523d5f602084013e6102df565b606091505b5050905080156102f25750505050505050565b505b5060010161018f565b50600101610181565b50505050565b604080515f8082526020820180845287905260ff861692820192909252606081018490526080810183905260019060a0016020604051602081039080840390855afa15801561035d573d5f5f3e3d5ffd5b5050604051601f1901519695505050505050565b5f5f5f5f5f306001600160a01b0316631040b0bc6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156103b2573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103d69190610685565b604080515f808252602082018084528490529181018290526060810182905260808101919091529091506001600160a01b0387169060019060a0016020604051602081039080840390855afa158015610431573d5f5f3e3d5ffd5b505050602060405103516001600160a01b03160361045c5750600193505f9250829150819050610612565b5f5b601e8160ff1610156104f757604080515f81526020810180835284905260ff831691810191909152600160608201819052608082018190526001600160a01b0389169160a0016020604051602081039080840390855afa1580156104c4573d5f5f3e3d5ffd5b505050602060405103516001600160a01b0316036104ef576001955093508492508291506106129050565b60010161045e565b50604080515f80825260208201808452849052601b9282019290925260608101919091526001608082018190526001600160a01b0388169160a0016020604051602081039080840390855afa158015610552573d5f5f3e3d5ffd5b505050602060405103516001600160a01b03160361057e575060019350601b92505f9150839050610612565b604080515f80825260208201808452849052601c9282019290925260608101919091526001608082018190526001600160a01b0388169160a0016020604051602081039080840390855afa1580156105d8573d5f5f3e3d5ffd5b505050602060405103516001600160a01b031603610604575060019350601c92505f9150839050610612565b505f93508392508291508190505b9193509193565b5f60208284031215610629575f5ffd5b81356001600160a01b038116811461063f575f5ffd5b9392505050565b5f5f5f5f60808587031215610659575f5ffd5b84359350602085013560ff81168114610670575f5ffd5b93969395505050506040820135916060013590565b5f60208284031215610695575f5ffd5b5051919050565b5f82515f5b818110156106bb57602081860181015185830152016106a1565b505f92019182525091905056fea2646970667358221220fb87c8320b4b44e7cfbd40c3ffe03c7176627db276932794fb941f90528538ee64736f6c634300081c0033","sourceMap":"58:2821:0:-:0;;;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f5ffd5b506004361061004a575f3560e01c80630aeb4ddf1461004e5780631040b0bc1461006357806328f8ec99146100a5578063aa6abb9b146100d0575b5f5ffd5b61006161005c366004610619565b610107565b005b7f19457468657265756d205369676e6564204d6573736167653a0a3332000000005f908152610539601c52603c90206040519081526020015b60405180910390f35b6100b86100b3366004610646565b61030c565b6040516001600160a01b03909116815260200161009c565b6100e36100de366004610619565b610371565b60408051941515855260ff909316602085015291830152606082015260800161009c565b5f306001600160a01b0316631040b0bc6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610144573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101689190610685565b90507342069d82d9592991704e6e41bf2589a76ead1a915f5b601e8160ff161015610306575f5b600a8110156102fd57604080515f8082526020820180845287905260ff851692820192909252606081018390526080810183905260019060a0016020604051602081039080840390855afa1580156101e9573d5f5f3e3d5ffd5b505050602060405103519050836001600160a01b0316816001600160a01b0316036102f45760405160ff8416602482015260448101839052606481018390523360848201525f906001600160a01b0388169060a40160408051601f198184030181529181526020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167f3e8cd57000000000000000000000000000000000000000000000000000000000179052516102a1919061069c565b5f604051808303815f865af19150503d805f81146102da576040519150601f19603f3d011682016040523d82523d5f602084013e6102df565b606091505b5050905080156102f25750505050505050565b505b5060010161018f565b50600101610181565b50505050565b604080515f8082526020820180845287905260ff861692820192909252606081018490526080810183905260019060a0016020604051602081039080840390855afa15801561035d573d5f5f3e3d5ffd5b5050604051601f1901519695505050505050565b5f5f5f5f5f306001600160a01b0316631040b0bc6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156103b2573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103d69190610685565b604080515f808252602082018084528490529181018290526060810182905260808101919091529091506001600160a01b0387169060019060a0016020604051602081039080840390855afa158015610431573d5f5f3e3d5ffd5b505050602060405103516001600160a01b03160361045c5750600193505f9250829150819050610612565b5f5b601e8160ff1610156104f757604080515f81526020810180835284905260ff831691810191909152600160608201819052608082018190526001600160a01b0389169160a0016020604051602081039080840390855afa1580156104c4573d5f5f3e3d5ffd5b505050602060405103516001600160a01b0316036104ef576001955093508492508291506106129050565b60010161045e565b50604080515f80825260208201808452849052601b9282019290925260608101919091526001608082018190526001600160a01b0388169160a0016020604051602081039080840390855afa158015610552573d5f5f3e3d5ffd5b505050602060405103516001600160a01b03160361057e575060019350601b92505f9150839050610612565b604080515f80825260208201808452849052601c9282019290925260608101919091526001608082018190526001600160a01b0388169160a0016020604051602081039080840390855afa1580156105d8573d5f5f3e3d5ffd5b505050602060405103516001600160a01b031603610604575060019350601c92505f9150839050610612565b505f93508392508291508190505b9193509193565b5f60208284031215610629575f5ffd5b81356001600160a01b038116811461063f575f5ffd5b9392505050565b5f5f5f5f60808587031215610659575f5ffd5b84359350602085013560ff81168114610670575f5ffd5b93969395505050506040820135916060013590565b5f60208284031215610695575f5ffd5b5051919050565b5f82515f5b818110156106bb57602081860181015185830152016106a1565b505f92019182525091905056fea2646970667358221220fb87c8320b4b44e7cfbd40c3ffe03c7176627db276932794fb941f90528538ee64736f6c634300081c0033","sourceMap":"58:2821:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1898:979;;;;;;:::i;:::-;;:::i;:::-;;336:276;461:34;381:7;448:48;;;522:4;516;509:18;567:4;551:21;;336:276;;474:25:1;;;462:2;447:18;336:276:0;;;;;;;;128:154;;;;;;:::i;:::-;;:::i;:::-;;;-1:-1:-1;;;;;1311:55:1;;;1293:74;;1281:2;1266:18;128:154:0;1147:226:1;697:1161:0;;;;;;:::i;:::-;;:::i;:::-;;;;1624:14:1;;1617:22;1599:41;;1688:4;1676:17;;;1671:2;1656:18;;1649:45;1710:18;;;1703:34;1768:2;1753:18;;1746:34;1586:3;1571:19;697:1161:0;1378:408:1;1898:979:0;2005:15;2023:4;-1:-1:-1;;;;;2023:15:0;;:17;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;2005:35;-1:-1:-1;2155:42:0;2138:14;2242:629;2264:2;2260:1;:6;;;2242:629;;;2292:9;2287:574;2311:2;2307:1;:6;2287:574;;;2358:45;;;2338:17;2358:45;;;;;;;;;2207:25:1;;;2280:4;2268:17;;2248:18;;;2241:45;;;;2302:18;;;2295:34;;;2345:18;;;2338:34;;;2358:45:0;;2179:19:1;;2358:45:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2338:65;;2438:6;-1:-1:-1;;;;;2425:19:0;:9;-1:-1:-1;;;;;2425:19:0;;2421:426;;2570:195;;2640:4:1;2628:17;;2570:195:0;;;2610:36:1;2662:18;;;2655:34;;;2705:18;;;2698:34;;;2729:10:0;2748:18:1;;;2741:83;2516:12:0;;-1:-1:-1;;;;;2533:11:0;;;2582:19:1;;2570:195:0;;;-1:-1:-1;;2570:195:0;;;;;;;;;;;;;;;;;;;;2533:254;;;2570:195;2533:254;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2515:272;;;2813:7;2809:20;;;2822:7;;;;;;1898:979;:::o;2809:20::-;2446:401;2421:426;-1:-1:-1;2315:3:0;;2287:574;;;-1:-1:-1;2268:3:0;;2242:629;;;;1940:937;;1898:979;:::o;128:154::-;248:27;;;222:7;248:27;;;;;;;;;2207:25:1;;;2280:4;2268:17;;2248:18;;;2241:45;;;;2302:18;;;2295:34;;;2345:18;;;2338:34;;;248:27:0;;2179:19:1;;248:27:0;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;248:27:0;;-1:-1:-1;;248:27:0;;;128:154;-1:-1:-1;;;;;;128:154:0:o;697:1161::-;759:10;771:7;780:9;791;812:15;830:4;-1:-1:-1;;;;;830:15:0;;:17;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1024:45;;;1043:1;1024:45;;;;;;;;;2207:25:1;;;2248:18;;;2241:45;;;2302:18;;;2295:34;;;2345:18;;;2338:34;;;;812:35:0;;-1:-1:-1;;;;;;1024:55:0;;;:45;;2179:19:1;;1024:45:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;;;;1024:55:0;;1020:126;;-1:-1:-1;1103:4:0;;-1:-1:-1;1109:1:0;;-1:-1:-1;1109:1:0;;-1:-1:-1;1109:1:0;;-1:-1:-1;1095:40:0;;1020:126;1210:7;1205:225;1227:2;1223:1;:6;;;1205:225;;;1254:63;;;1276:19;1254:63;;;;;;;;2207:25:1;;;2280:4;2268:17;;2248:18;;;2241:45;;;;1254:63:0;2302:18:1;;;2295:34;;;2345:18;;;2338:34;;;-1:-1:-1;;;;;1254:73:0;;;2179:19:1;;1254:63:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;;;;1254:73:0;;1250:170;;1355:4;;-1:-1:-1;1361:1:0;-1:-1:-1;1355:4:0;;-1:-1:-1;1355:4:0;;-1:-1:-1;1347:58:0;;-1:-1:-1;1347:58:0;1250:170;1231:3;;1205:225;;;-1:-1:-1;1495:55:0;;;1526:1;1495:55;;;;;;;;;2207:25:1;;;1514:2:0;2248:18:1;;;2241:45;;;;2302:18;;;2295:34;;;;1495:55:0;2345:18:1;;;2338:34;;;-1:-1:-1;;;;;1495:65:0;;;2179:19:1;;1495:55:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;;;;1495:65:0;;1491:146;;-1:-1:-1;1584:4:0;;-1:-1:-1;1590:2:0;;-1:-1:-1;1602:1:0;;-1:-1:-1;1584:4:0;;-1:-1:-1;1576:50:0;;1491:146;1650:55;;;1681:1;1650:55;;;;;;;;;2207:25:1;;;1669:2:0;2248:18:1;;;2241:45;;;;2302:18;;;2295:34;;;;1650:55:0;2345:18:1;;;2338:34;;;-1:-1:-1;;;;;1650:65:0;;;2179:19:1;;1650:55:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;;;;1650:65:0;;1646:146;;-1:-1:-1;1739:4:0;;-1:-1:-1;1745:2:0;;-1:-1:-1;1757:1:0;;-1:-1:-1;1739:4:0;;-1:-1:-1;1731:50:0;;1646:146;-1:-1:-1;1818:5:0;;-1:-1:-1;1818:5:0;;-1:-1:-1;1818:5:0;;-1:-1:-1;1818:5:0;;-1:-1:-1;697:1161:0;;;;;;:::o;14:309:1:-;73:6;126:2;114:9;105:7;101:23;97:32;94:52;;;142:1;139;132:12;94:52;181:9;168:23;-1:-1:-1;;;;;224:5:1;220:54;213:5;210:65;200:93;;289:1;286;279:12;200:93;312:5;14:309;-1:-1:-1;;;14:309:1:o;510:632::-;594:6;602;610;618;671:3;659:9;650:7;646:23;642:33;639:53;;;688:1;685;678:12;639:53;733:23;;;-1:-1:-1;832:2:1;817:18;;804:32;880:4;867:18;;855:31;;845:59;;900:1;897;890:12;845:59;510:632;;923:7;;-1:-1:-1;;;;1003:2:1;988:18;;975:32;;1106:2;1091:18;1078:32;;510:632::o;1791:184::-;1861:6;1914:2;1902:9;1893:7;1889:23;1885:32;1882:52;;;1930:1;1927;1920:12;1882:52;-1:-1:-1;1953:16:1;;1791:184;-1:-1:-1;1791:184:1:o;2835:412::-;2964:3;3002:6;2996:13;3027:1;3037:129;3051:6;3048:1;3045:13;3037:129;;;3149:4;3133:14;;;3129:25;;3123:32;3110:11;;;3103:53;3066:12;3037:129;;;-1:-1:-1;3221:1:1;3185:16;;3210:13;;;-1:-1:-1;3185:16:1;2835:412;-1:-1:-1;2835:412:1:o","linkReferences":{}},"methodIdentifiers":{"exploit(address)":"0aeb4ddf","findSignature(address)":"aa6abb9b","getMsgHash()":"1040b0bc","testEcrecover(bytes32,uint8,bytes32,bytes32)":"28f8ec99"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.28+commit.7893614a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"locker\",\"type\":\"address\"}],\"name\":\"exploit\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"target\",\"type\":\"address\"}],\"name\":\"findSignature\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"found\",\"type\":\"bool\"},{\"internalType\":\"uint8\",\"name\":\"v\",\"type\":\"uint8\"},{\"internalType\":\"bytes32\",\"name\":\"r\",\"type\":\"bytes32\"},{\"internalType\":\"bytes32\",\"name\":\"s\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getMsgHash\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"pure\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"msgHash\",\"type\":\"bytes32\"},{\"internalType\":\"uint8\",\"name\":\"v\",\"type\":\"uint8\"},{\"internalType\":\"bytes32\",\"name\":\"r\",\"type\":\"bytes32\"},{\"internalType\":\"bytes32\",\"name\":\"s\",\"type\":\"bytes32\"}],\"name\":\"testEcrecover\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"pure\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/answers/EcrecoverExploit.sol\":\"EcrecoverExploit\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/answers/EcrecoverExploit.sol\":{\"keccak256\":\"0xb44229b78ecc6f8487ab93a656ceddc13466286356b936a829bb4fa55dedea1c\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://f7efbf6a4140da12298a3bfb9d8a9a82437d0f5600440a3e23fbc812d0ad252e\",\"dweb:/ipfs/QmeKUfwE3DdAgPoZ5m9oMupr9Q6a4axJa2tGrmMrnLq5TS\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.28+commit.7893614a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"locker","type":"address"}],"stateMutability":"nonpayable","type":"function","name":"exploit"},{"inputs":[{"internalType":"address","name":"target","type":"address"}],"stateMutability":"view","type":"function","name":"findSignature","outputs":[{"internalType":"bool","name":"found","type":"bool"},{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}]},{"inputs":[],"stateMutability":"pure","type":"function","name":"getMsgHash","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}]},{"inputs":[{"internalType":"bytes32","name":"msgHash","type":"bytes32"},{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"stateMutability":"pure","type":"function","name":"testEcrecover","outputs":[{"internalType":"address","name":"","type":"address"}]}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/answers/EcrecoverExploit.sol":"EcrecoverExploit"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/answers/EcrecoverExploit.sol":{"keccak256":"0xb44229b78ecc6f8487ab93a656ceddc13466286356b936a829bb4fa55dedea1c","urls":["bzz-raw://f7efbf6a4140da12298a3bfb9d8a9a82437d0f5600440a3e23fbc812d0ad252e","dweb:/ipfs/QmeKUfwE3DdAgPoZ5m9oMupr9Q6a4axJa2tGrmMrnLq5TS"],"license":"MIT"}},"version":1},"id":0}