{"abi":[{"type":"constructor","inputs":[{"name":"_target","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"function","name":"analyzeEncoding","inputs":[{"name":"animal","type":"string","internalType":"string"}],"outputs":[{"name":"encoded","type":"uint256","internalType":"uint256"},{"name":"shiftedWrong","type":"uint256","internalType":"uint256"},{"name":"shiftedCorrect","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"checkProgress","inputs":[],"outputs":[{"name":"currentId","type":"uint256","internalType":"uint256"},{"name":"crate0","type":"uint256","internalType":"uint256"},{"name":"crate1","type":"uint256","internalType":"uint256"},{"name":"crate65535","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"directApproach","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"exploitOverflow","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"target","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IMagicAnimalCarousel"}],"stateMutability":"view"}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b506040516106e93803806106e9833981016040819052602b91604e565b5f80546001600160a01b0319166001600160a01b03929092169190911790556079565b5f60208284031215605d575f5ffd5b81516001600160a01b03811681146072575f5ffd5b9392505050565b610663806100865f395ff3fe608060405234801561000f575f5ffd5b5060043610610064575f3560e01c8063d4b839921161004d578063d4b83992146100a5578063e4c35e29146100cf578063e9a8df0a146100d7575f5ffd5b806346c7257f14610068578063bd69bc1d14610072575b5f5ffd5b6100706100ff565b005b610085610080366004610504565b610209565b604080519384526020840192909252908201526060015b60405180910390f35b5f546100b7906001600160a01b031681565b6040516001600160a01b03909116815260200161009c565b6100706102c7565b6100df610328565b60408051948552602085019390935291830152606082015260800161009c565b60408051600c8082528183019092525f9160208201818036833701905050905060ff60f81b815f81518110610136576101366105b7565b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690815f1a90535060ff60f81b8160018151811061017c5761017c6105b7565b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690815f1a9053505f54604051632acee48960e21b81526001600160a01b039091169063ab3b9224906101d99084906004016105cb565b5f604051808303815f87803b1580156101f0575f5ffd5b505af1158015610202573d5f5f3e3d5ffd5b5050505050565b5f80546040517f76997b75000000000000000000000000000000000000000000000000000000008152829182916001600160a01b03909116906376997b75906102569087906004016105cb565b602060405180830381865afa158015610271573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102959190610616565b947fffffffffffffffffffff0000000000000000000000000000000000000000000060a087901b169450849350915050565b604080518082018252600c81527ff09fa684f09fa684f09fa684000000000000000000000000000000000000000060208201525f549151632acee48960e21b815290916001600160a01b03169063ab3b9224906101d99084906004016105cb565b5f5f5f5f5f5f9054906101000a90046001600160a01b03166001600160a01b03166326bad99e6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561037b573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061039f9190610616565b5f80546040516324da12f560e21b81529296506001600160a01b0316916393684bd4916103d29160040190815260200190565b602060405180830381865afa1580156103ed573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104119190610616565b5f546040516324da12f560e21b8152600160048201529194506001600160a01b0316906393684bd490602401602060405180830381865afa158015610458573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061047c9190610616565b5f546040516324da12f560e21b815261ffff60048201529193506001600160a01b0316906393684bd490602401602060405180830381865afa1580156104c4573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104e89190610616565b905090919293565b634e487b7160e01b5f52604160045260245ffd5b5f60208284031215610514575f5ffd5b813567ffffffffffffffff81111561052a575f5ffd5b8201601f8101841361053a575f5ffd5b803567ffffffffffffffff811115610554576105546104f0565b604051601f8201601f19908116603f0116810167ffffffffffffffff81118282101715610583576105836104f0565b60405281815282820160200186101561059a575f5ffd5b816020840160208301375f91810160200191909152949350505050565b634e487b7160e01b5f52603260045260245ffd5b602081525f82518060208401525f5b818110156105f757602081860181015160408684010152016105da565b505f604082850101526040601f19601f83011684010191505092915050565b5f60208284031215610626575f5ffd5b505191905056fea26469706673582212205558726d0154e003a0c75121c954fef89ed3b93e0f71c714569d6933ee15222e64736f6c634300081c0033","sourceMap":"461:2724:0:-:0;;;746:84;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;785:6;:38;;-1:-1:-1;;;;;;785:38:0;-1:-1:-1;;;;;785:38:0;;;;;;;;;;461:2724;;14:290:1;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:1;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:1:o;:::-;461:2724:0;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f5ffd5b5060043610610064575f3560e01c8063d4b839921161004d578063d4b83992146100a5578063e4c35e29146100cf578063e9a8df0a146100d7575f5ffd5b806346c7257f14610068578063bd69bc1d14610072575b5f5ffd5b6100706100ff565b005b610085610080366004610504565b610209565b604080519384526020840192909252908201526060015b60405180910390f35b5f546100b7906001600160a01b031681565b6040516001600160a01b03909116815260200161009c565b6100706102c7565b6100df610328565b60408051948552602085019390935291830152606082015260800161009c565b60408051600c8082528183019092525f9160208201818036833701905050905060ff60f81b815f81518110610136576101366105b7565b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690815f1a90535060ff60f81b8160018151811061017c5761017c6105b7565b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690815f1a9053505f54604051632acee48960e21b81526001600160a01b039091169063ab3b9224906101d99084906004016105cb565b5f604051808303815f87803b1580156101f0575f5ffd5b505af1158015610202573d5f5f3e3d5ffd5b5050505050565b5f80546040517f76997b75000000000000000000000000000000000000000000000000000000008152829182916001600160a01b03909116906376997b75906102569087906004016105cb565b602060405180830381865afa158015610271573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102959190610616565b947fffffffffffffffffffff0000000000000000000000000000000000000000000060a087901b169450849350915050565b604080518082018252600c81527ff09fa684f09fa684f09fa684000000000000000000000000000000000000000060208201525f549151632acee48960e21b815290916001600160a01b03169063ab3b9224906101d99084906004016105cb565b5f5f5f5f5f5f9054906101000a90046001600160a01b03166001600160a01b03166326bad99e6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561037b573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061039f9190610616565b5f80546040516324da12f560e21b81529296506001600160a01b0316916393684bd4916103d29160040190815260200190565b602060405180830381865afa1580156103ed573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104119190610616565b5f546040516324da12f560e21b8152600160048201529194506001600160a01b0316906393684bd490602401602060405180830381865afa158015610458573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061047c9190610616565b5f546040516324da12f560e21b815261ffff60048201529193506001600160a01b0316906393684bd490602401602060405180830381865afa1580156104c4573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104e89190610616565b905090919293565b634e487b7160e01b5f52604160045260245ffd5b5f60208284031215610514575f5ffd5b813567ffffffffffffffff81111561052a575f5ffd5b8201601f8101841361053a575f5ffd5b803567ffffffffffffffff811115610554576105546104f0565b604051601f8201601f19908116603f0116810167ffffffffffffffff81118282101715610583576105836104f0565b60405281815282820160200186101561059a575f5ffd5b816020840160208301375f91810160200191909152949350505050565b634e487b7160e01b5f52603260045260245ffd5b602081525f82518060208401525f5b818110156105f757602081860181015160408684010152016105da565b505f604082850101526040601f19601f83011684010191505092915050565b5f60208284031215610626575f5ffd5b505191905056fea26469706673582212205558726d0154e003a0c75121c954fef89ed3b93e0f71c714569d6933ee15222e64736f6c634300081c0033","sourceMap":"461:2724:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2089:794;;;:::i;:::-;;840:336;;;;;;:::i;:::-;;:::i;:::-;;;;1355:25:1;;;1411:2;1396:18;;1389:34;;;;1439:18;;;1432:34;1343:2;1328:18;840:336:0;;;;;;;;490:34;;;;;-1:-1:-1;;;;;490:34:0;;;;;;-1:-1:-1;;;;;1668:55:1;;;1650:74;;1638:2;1623:18;490:34:0;1477:253:1;1186:893:0;;;:::i;2893:290::-;;;:::i;:::-;;;;1966:25:1;;;2022:2;2007:18;;2000:34;;;;2050:18;;;2043:34;2108:2;2093:18;;2086:34;1953:3;1938:19;2893:290:0;1735:391:1;2089:794:0;2668:13;;;2678:2;2668:13;;;;;;;;;2641:24;;2668:13;;;;;;;;;;-1:-1:-1;2668:13:0;2641:40;;2778:4;2761:21;;:11;2773:1;2761:14;;;;;;;;:::i;:::-;;;;:21;;;;;;;;;;;2809:4;2792:21;;:11;2804:1;2792:14;;;;;;;;:::i;:::-;;;;:21;;;;;;;;;;-1:-1:-1;2832:6:0;;:44;;-1:-1:-1;;;2832:44:0;;-1:-1:-1;;;;;2832:6:0;;;;:23;;:44;;2863:11;;2832:44;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2124:759;2089:794::o;840:336::-;910:15;993:6;;:31;;;;;910:15;;;;-1:-1:-1;;;;;993:6:0;;;;:23;;:31;;1017:6;;993:31;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;983:41;1049:20;;;;;;;-1:-1:-1;1049:20:0;;-1:-1:-1;840:336:0;-1:-1:-1;;840:336:0:o;1186:893::-;1958:44;;;;;;;;;;;;;;;;:20;2041:6;:31;;-1:-1:-1;;;2041:31:0;;1958:44;;-1:-1:-1;;;;;2041:6:0;;:23;;:31;;1958:44;;2041:31;;;:::i;2893:290::-;2941:17;2960:14;2976;2992:18;3034:6;;;;;;;;;-1:-1:-1;;;;;3034:6:0;-1:-1:-1;;;;;3034:21:0;;:23;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;3076:6;;;:18;;-1:-1:-1;;;3076:18:0;;3022:35;;-1:-1:-1;;;;;;3076:6:0;;:15;;:18;;;;3195:25:1;;;3183:2;3168:18;;3041:185;3076:18:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;3113:6;;:18;;-1:-1:-1;;;3113:18:0;;:6;:18;;;3195:25:1;3067:27:0;;-1:-1:-1;;;;;;3113:6:0;;:15;;3168:18:1;;3113::0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;3154:6;;:22;;-1:-1:-1;;;3154:22:0;;3170:5;3154:22;;;3195:25:1;3104:27:0;;-1:-1:-1;;;;;;3154:6:0;;:15;;3168:18:1;;3154:22:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;3141:35;;2893:290;;;;:::o;14:184:1:-;-1:-1:-1;;;63:1:1;56:88;163:4;160:1;153:15;187:4;184:1;177:15;203:945;272:6;325:2;313:9;304:7;300:23;296:32;293:52;;;341:1;338;331:12;293:52;381:9;368:23;414:18;406:6;403:30;400:50;;;446:1;443;436:12;400:50;469:22;;522:4;514:13;;510:27;-1:-1:-1;500:55:1;;551:1;548;541:12;500:55;591:2;578:16;617:18;609:6;606:30;603:56;;;639:18;;:::i;:::-;688:2;682:9;780:2;742:17;;-1:-1:-1;;738:31:1;;;771:2;734:40;730:54;718:67;;815:18;800:34;;836:22;;;797:62;794:88;;;862:18;;:::i;:::-;898:2;891:22;922;;;963:15;;;980:2;959:24;956:37;-1:-1:-1;953:57:1;;;1006:1;1003;996:12;953:57;1062:6;1057:2;1053;1049:11;1044:2;1036:6;1032:15;1019:50;1115:1;1089:19;;;1110:2;1085:28;1078:39;;;;1093:6;203:945;-1:-1:-1;;;;203:945:1:o;2131:184::-;-1:-1:-1;;;2180:1:1;2173:88;2280:4;2277:1;2270:15;2304:4;2301:1;2294:15;2320:527;2469:2;2458:9;2451:21;2432:4;2501:6;2495:13;2544:6;2539:2;2528:9;2524:18;2517:34;2569:1;2579:140;2593:6;2590:1;2587:13;2579:140;;;2704:2;2688:14;;;2684:23;;2678:30;2673:2;2654:17;;;2650:26;2643:66;2608:10;2579:140;;;2583:3;2768:1;2763:2;2754:6;2743:9;2739:22;2735:31;2728:42;2838:2;2831;2827:7;2822:2;2814:6;2810:15;2806:29;2795:9;2791:45;2787:54;2779:62;;;2320:527;;;;:::o;2852:184::-;2922:6;2975:2;2963:9;2954:7;2950:23;2946:32;2943:52;;;2991:1;2988;2981:12;2943:52;-1:-1:-1;3014:16:1;;2852:184;-1:-1:-1;2852:184:1:o","linkReferences":{}},"methodIdentifiers":{"analyzeEncoding(string)":"bd69bc1d","checkProgress()":"e9a8df0a","directApproach()":"46c7257f","exploitOverflow()":"e4c35e29","target()":"d4b83992"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.28+commit.7893614a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_target\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[{\"internalType\":\"string\",\"name\":\"animal\",\"type\":\"string\"}],\"name\":\"analyzeEncoding\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"encoded\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"shiftedWrong\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"shiftedCorrect\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"checkProgress\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"currentId\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"crate0\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"crate1\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"crate65535\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"directApproach\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"exploitOverflow\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"target\",\"outputs\":[{\"internalType\":\"contract IMagicAnimalCarousel\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/answers/PreciseAttack.sol\":\"PreciseAttack\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/answers/PreciseAttack.sol\":{\"keccak256\":\"0x48045a676325db8b7cb33f57ee4c8eba0c16b00cd124740f08b88ecf467282f7\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://e42bb024e3f5599ff03790921479d50dd87e323ce9e1a4fdfcd235eda993d912\",\"dweb:/ipfs/QmbiSBwnjm8CX8UU1VDAPA44irYJLRaTf4DGQtPJTYxUZK\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.28+commit.7893614a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_target","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"string","name":"animal","type":"string"}],"stateMutability":"view","type":"function","name":"analyzeEncoding","outputs":[{"internalType":"uint256","name":"encoded","type":"uint256"},{"internalType":"uint256","name":"shiftedWrong","type":"uint256"},{"internalType":"uint256","name":"shiftedCorrect","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"checkProgress","outputs":[{"internalType":"uint256","name":"currentId","type":"uint256"},{"internalType":"uint256","name":"crate0","type":"uint256"},{"internalType":"uint256","name":"crate1","type":"uint256"},{"internalType":"uint256","name":"crate65535","type":"uint256"}]},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"directApproach"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"exploitOverflow"},{"inputs":[],"stateMutability":"view","type":"function","name":"target","outputs":[{"internalType":"contract IMagicAnimalCarousel","name":"","type":"address"}]}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/answers/PreciseAttack.sol":"PreciseAttack"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/answers/PreciseAttack.sol":{"keccak256":"0x48045a676325db8b7cb33f57ee4c8eba0c16b00cd124740f08b88ecf467282f7","urls":["bzz-raw://e42bb024e3f5599ff03790921479d50dd87e323ce9e1a4fdfcd235eda993d912","dweb:/ipfs/QmbiSBwnjm8CX8UU1VDAPA44irYJLRaTf4DGQtPJTYxUZK"],"license":"MIT"}},"version":1},"id":0}