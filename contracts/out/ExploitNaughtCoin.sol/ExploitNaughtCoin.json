{"abi":[{"type":"constructor","inputs":[{"name":"_naughtCoin","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"function","name":"drainTokens","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"naughtCoin","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract INaughtCoin"}],"stateMutability":"view"},{"type":"function","name":"owner","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"step1_approve","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"step2_transfer","inputs":[],"outputs":[],"stateMutability":"nonpayable"}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b5060405161050c38038061050c833981016040819052602b916057565b5f80546001600160a01b039092166001600160a01b031992831617905560018054909116331790556082565b5f602082840312156066575f5ffd5b81516001600160a01b0381168114607b575f5ffd5b9392505050565b61047d8061008f5f395ff3fe608060405234801561000f575f5ffd5b5060043610610064575f3560e01c80636856876d1161004d5780636856876d1461007a5780638da5cb5b146100a8578063ef1706ce146100bb575f5ffd5b80632422dbf61461006857806360cf172c14610072575b5f5ffd5b6100706100c3565b005b6100706101b3565b5f5461008c906001600160a01b031681565b6040516001600160a01b03909116815260200160405180910390f35b60015461008c906001600160a01b031681565b6100706102d0565b5f80546001546040516370a0823160e01b81526001600160a01b0391821660048201529116906370a0823190602401602060405180830381865afa15801561010d573d5f5f3e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610131919061040a565b5f546001546040516323b872dd60e01b81526001600160a01b0391821660048201523060248201526044810184905292935016906323b872dd906064015b6020604051808303815f875af115801561018b573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101af9190610421565b5050565b6001546001600160a01b031633146102125760405162461bcd60e51b815260206004820152600a60248201527f4f6e6c79206f776e65720000000000000000000000000000000000000000000060448201526064015b60405180910390fd5b5f80546001546040516370a0823160e01b81526001600160a01b0391821660048201529116906370a0823190602401602060405180830381865afa15801561025c573d5f5f3e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610280919061040a565b5f546040517f095ea7b3000000000000000000000000000000000000000000000000000000008152306004820152602481018390529192506001600160a01b03169063095ea7b39060440161016f565b5f80546001546040516370a0823160e01b81526001600160a01b0391821660048201529116906370a0823190602401602060405180830381865afa15801561031a573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061033e919061040a565b5f546001546040516323b872dd60e01b81526001600160a01b0391821660048201523060248201526044810184905292935016906323b872dd906064016020604051808303815f875af1158015610397573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103bb9190610421565b6104075760405162461bcd60e51b815260206004820152600f60248201527f5472616e73666572206661696c656400000000000000000000000000000000006044820152606401610209565b50565b5f6020828403121561041a575f5ffd5b5051919050565b5f60208284031215610431575f5ffd5b81518015158114610440575f5ffd5b939250505056fea26469706673582212201282d3df0455e7bf683d32f43fba241651ec2bba3dd46cd00c7645842a1a9f0264736f6c634300081c0033","sourceMap":"356:961:0:-:0;;;455:115;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;498:10;:37;;-1:-1:-1;;;;;498:37:0;;;-1:-1:-1;;;;;;498:37:0;;;;;;;545:18;;;;;553:10;545:18;;;356:961;;14:290:1;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:1;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:1:o;:::-;356:961:0;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f5ffd5b5060043610610064575f3560e01c80636856876d1161004d5780636856876d1461007a5780638da5cb5b146100a8578063ef1706ce146100bb575f5ffd5b80632422dbf61461006857806360cf172c14610072575b5f5ffd5b6100706100c3565b005b6100706101b3565b5f5461008c906001600160a01b031681565b6040516001600160a01b03909116815260200160405180910390f35b60015461008c906001600160a01b031681565b6100706102d0565b5f80546001546040516370a0823160e01b81526001600160a01b0391821660048201529116906370a0823190602401602060405180830381865afa15801561010d573d5f5f3e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610131919061040a565b5f546001546040516323b872dd60e01b81526001600160a01b0391821660048201523060248201526044810184905292935016906323b872dd906064015b6020604051808303815f875af115801561018b573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101af9190610421565b5050565b6001546001600160a01b031633146102125760405162461bcd60e51b815260206004820152600a60248201527f4f6e6c79206f776e65720000000000000000000000000000000000000000000060448201526064015b60405180910390fd5b5f80546001546040516370a0823160e01b81526001600160a01b0391821660048201529116906370a0823190602401602060405180830381865afa15801561025c573d5f5f3e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610280919061040a565b5f546040517f095ea7b3000000000000000000000000000000000000000000000000000000008152306004820152602481018390529192506001600160a01b03169063095ea7b39060440161016f565b5f80546001546040516370a0823160e01b81526001600160a01b0391821660048201529116906370a0823190602401602060405180830381865afa15801561031a573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061033e919061040a565b5f546001546040516323b872dd60e01b81526001600160a01b0391821660048201523060248201526044810184905292935016906323b872dd906064016020604051808303815f875af1158015610397573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103bb9190610421565b6104075760405162461bcd60e51b815260206004820152600f60248201527f5472616e73666572206661696c656400000000000000000000000000000000006044820152606401610209565b50565b5f6020828403121561041a575f5ffd5b5051919050565b5f60208284031215610431575f5ffd5b81518015158114610440575f5ffd5b939250505056fea26469706673582212201282d3df0455e7bf683d32f43fba241651ec2bba3dd46cd00c7645842a1a9f0264736f6c634300081c0033","sourceMap":"356:961:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;910:161;;;:::i;:::-;;641:200;;;:::i;389:29::-;;;;;-1:-1:-1;;;;;389:29:0;;;;;;-1:-1:-1;;;;;196:55:1;;;178:74;;166:2;151:18;389:29:0;;;;;;;424:20;;;;;-1:-1:-1;;;;;424:20:0;;;1129:186;;;:::i;910:161::-;955:15;973:10;;;994:5;973:27;;-1:-1:-1;;;973:27:0;;-1:-1:-1;;;;;994:5:0;;;973:27;;;178:74:1;973:10:0;;;:20;;151:18:1;;973:27:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1010:10;;;1034:5;1010:54;;-1:-1:-1;;;1010:54:0;;-1:-1:-1;;;;;1034:5:0;;;1010:54;;;885:74:1;1049:4:0;975:18:1;;;968:83;1067:18;;;1060:34;;;955:45:0;;-1:-1:-1;1010:10:0;;:23;;858:18:1;;1010:54:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;945:126;910:161::o;641:200::-;707:5;;-1:-1:-1;;;;;707:5:0;693:10;:19;685:42;;;;-1:-1:-1;;;685:42:0;;1589:2:1;685:42:0;;;1571:21:1;1628:2;1608:18;;;1601:30;1667:12;1647:18;;;1640:40;1697:18;;685:42:0;;;;;;;;;737:15;755:10;;;776:5;755:27;;-1:-1:-1;;;755:27:0;;-1:-1:-1;;;;;776:5:0;;;755:27;;;178:74:1;755:10:0;;;:20;;151:18:1;;755:27:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;792:10;;:42;;;;;819:4;792:42;;;1900:74:1;1990:18;;;1983:34;;;737:45:0;;-1:-1:-1;;;;;;792:10:0;;:18;;1873::1;;792:42:0;1726:297:1;1129:186:0;1171:15;1189:10;;;1210:5;1189:27;;-1:-1:-1;;;1189:27:0;;-1:-1:-1;;;;;1210:5:0;;;1189:27;;;178:74:1;1189:10:0;;;:20;;151:18:1;;1189:27:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1234:10;;;1258:5;1234:54;;-1:-1:-1;;;1234:54:0;;-1:-1:-1;;;;;1258:5:0;;;1234:54;;;885:74:1;1273:4:0;975:18:1;;;968:83;1067:18;;;1060:34;;;1171:45:0;;-1:-1:-1;1234:10:0;;:23;;858:18:1;;1234:54:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1226:82;;;;-1:-1:-1;;;1226:82:0;;2230:2:1;1226:82:0;;;2212:21:1;2269:2;2249:18;;;2242:30;2308:17;2288:18;;;2281:45;2343:18;;1226:82:0;2028:339:1;1226:82:0;1161:154;1129:186::o;494:184:1:-;564:6;617:2;605:9;596:7;592:23;588:32;585:52;;;633:1;630;623:12;585:52;-1:-1:-1;656:16:1;;494:184;-1:-1:-1;494:184:1:o;1105:277::-;1172:6;1225:2;1213:9;1204:7;1200:23;1196:32;1193:52;;;1241:1;1238;1231:12;1193:52;1273:9;1267:16;1326:5;1319:13;1312:21;1305:5;1302:32;1292:60;;1348:1;1345;1338:12;1292:60;1371:5;1105:277;-1:-1:-1;;;1105:277:1:o","linkReferences":{}},"methodIdentifiers":{"drainTokens()":"ef1706ce","naughtCoin()":"6856876d","owner()":"8da5cb5b","step1_approve()":"60cf172c","step2_transfer()":"2422dbf6"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.28+commit.7893614a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_naughtCoin\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"drainTokens\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"naughtCoin\",\"outputs\":[{\"internalType\":\"contract INaughtCoin\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"step1_approve\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"step2_transfer\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/answers/ExploitNaughtCoin.sol\":\"ExploitNaughtCoin\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/answers/ExploitNaughtCoin.sol\":{\"keccak256\":\"0xbe2be345c493cf2b268c31738165032d79a0f71bd9aa7554ef24ce821ffa82a1\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://bbf7e8d557411682919c8f716b22da68d178234d6026f8ea46027c949e2f4e1f\",\"dweb:/ipfs/QmXy2WzY3rr2xJza3pFzZWWfL2NJm6rarZhgXDwqDV1biF\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.28+commit.7893614a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_naughtCoin","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"drainTokens"},{"inputs":[],"stateMutability":"view","type":"function","name":"naughtCoin","outputs":[{"internalType":"contract INaughtCoin","name":"","type":"address"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"step1_approve"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"step2_transfer"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/answers/ExploitNaughtCoin.sol":"ExploitNaughtCoin"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/answers/ExploitNaughtCoin.sol":{"keccak256":"0xbe2be345c493cf2b268c31738165032d79a0f71bd9aa7554ef24ce821ffa82a1","urls":["bzz-raw://bbf7e8d557411682919c8f716b22da68d178234d6026f8ea46027c949e2f4e1f","dweb:/ipfs/QmXy2WzY3rr2xJza3pFzZWWfL2NJm6rarZhgXDwqDV1biF"],"license":"MIT"}},"version":1},"id":0}